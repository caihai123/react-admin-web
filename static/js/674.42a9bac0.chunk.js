"use strict";(self.webpackChunkreact_admin_web=self.webpackChunkreact_admin_web||[]).push([[674],{60824:function(e,t,n){n.d(t,{S:function(){return o},n:function(){return l}});var r=n(95694);const o=()=>r.Z.get("/api/menu/all"),l=e=>r.Z.post("/api/menu/remove",{id:e})},99375:function(e,t,n){n.d(t,{GG:function(){return l},JV:function(){return o},fs:function(){return s},l5:function(){return a},sv:function(){return c}});var r=n(95694);const o=(e,t=1,n=10)=>r.Z.post("/api/role/page",{params:e,pageIndex:t,pageSize:n}),l=(e,t)=>r.Z.post("/api/role/status/update",{id:e,status:t}),a=e=>r.Z.post("/api/role/remove",{id:e}),s=e=>r.Z.post("/api/role/auth",e),c=()=>r.Z.get("/api/role/select")},81375:function(e,t,n){var r=n(89526),o=n(20485),l=n(9740),a=n(74918),s=n(96799),c=n(5416),i=n(95267),d=n(49839),u=n(67557);const p=(0,r.forwardRef)((function(e,t){const{title:n,width:d,submitText:p="确定",cancelText:h="取消",children:f,modalProps:m,formProps:g,onFinish:b,footer:C,initialValues:k,afterClose:y}=e,[x,{set:Z}]=(0,o.Z)(!1),[v,j]=(0,i.ZP)(!1);return(0,r.useImperativeHandle)(t,(()=>({open:()=>Z(!0),close:()=>Z(!1)}))),(0,u.jsx)(l.Z,{title:n,open:x,onCancel:()=>Z(!1),width:d,footer:C||(0,u.jsxs)(a.Z,{children:[(0,u.jsx)(s.ZP,{onClick:()=>Z(!1),children:h}),(0,u.jsx)(s.ZP,{type:"primary",loading:v,onClick:()=>e.form?.submit(),children:p})]}),centered:!0,wrapClassName:"custom-modal-style",maskClosable:!1,afterClose:y,...m,children:(0,u.jsx)(c.Z,{form:e.form,autoComplete:"off",onFinish:e=>{const t=b?.(e);t instanceof Promise&&(j.setTrue(),t.then((()=>Z(!1))).finally((()=>j.setFalse())))},layout:"vertical",initialValues:k,...g,children:f})})}));t.Z=(0,d.Z)(p,{useModal:function(e){const t=(0,r.useRef)(null),[n]=c.Z.useForm();return[t,n,(0,u.jsx)(p,{ref:t,form:n,...e})]}})},9346:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(20485),o=n(49367),l=n(95267),a=n(67557);function s({defaultChecked:e=!1,onChange:t=(()=>null)}){const[n,{set:s}]=(0,r.Z)(e),[c,{setTrue:i,setFalse:d}]=(0,l.ZP)(!1);return(0,a.jsx)(o.Z,{checked:n,loading:c,onChange:e=>{s(e),i(),t(e)?.catch((()=>{s(!e)})).finally((()=>d()))}})}},61297:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var r=n(89526),o=n(72816),l=n(96799),a=n(74918),s=n(58047),c=n(25877),i=n(9346),d=n(5416),u=n(57503),p=n(95694),h=n(81375),f=n(49839),m=n(67557);const g=r.forwardRef(((e,t)=>{const{message:n}=o.Z.useApp(),[l,a]=r.useState(""),[s,c,i]=h.Z.useModal({title:l?"编辑":"新增",width:600,afterClose:()=>{a(""),c?.resetFields()},onFinish:function(t){const r=l?"/api/role/update":"/api/role/add",o=l?"更新成功！":"新增成功！",a=l?{id:l,...t}:t;return p.Z.post(r,a).then((()=>{n.success(o),e.callback(l?void 0:1)}))},children:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.Z.Item,{name:"roleName",label:"角色名称",rules:[{required:!0,message:"请填写角色名称"}],children:(0,m.jsx)(u.Z,{placeholder:"请输入"})}),(0,m.jsx)(d.Z.Item,{name:"description",label:"备注",children:(0,m.jsx)(u.Z.TextArea,{placeholder:"请输入"})})]})});return r.useImperativeHandle(t,(()=>({addStart:()=>s.current?.open(),editStart:e=>{a(e.id),c?.setFieldsValue(e),s.current?.open()}}))),i}));var b=(0,f.Z)(g,{useModal:function(e){const t=r.useRef(null);return[t,(0,m.jsx)(g,{ref:t,...e})]}}),C=n(16509),k=n(59827),y=n(9740),x=n(42434),Z=n(20485),v=n(88238),j=n(60824),S=n(99375),$=n(68347),w=n(22701),I=n(26482),P=n(95267),O=n(50706),T=n.n(O);const E=r.forwardRef(((e,t)=>{const[n,{set:l}]=(0,Z.Z)(!1),{message:a}=o.Z.useApp(),{data:s,loading:c,mutate:i,run:d}=(0,v.Z)((async e=>{const t=await(0,j.S)();return(0,I.ff)(t.result,(({children:e,...t})=>({...t,isAuth:T().mock({"boolean|1-2":!1}).boolean})))}),{manual:!0}),[u,p]=r.useState(!1),[h,f]=r.useState(!1);r.useEffect((()=>{const e=[],t=function(n=[]){n.forEach((n=>{e.push(n.isAuth),n.buttonList?.forEach((t=>{e.push(t.isAuth)})),t(n.children)}))};t(s),e.every((e=>!0===e))?(p(!0),f(!1)):e.every((e=>!0!==e))?(p(!1),f(!1)):(p(!1),f(!0))}),[s]);const g=r.useCallback((function(e){const t=function(n=[]){n.forEach((n=>{n.isAuth=e,n.buttonList?.forEach((t=>{t.isAuth=e})),t(n.children)}))};t(s),i((0,w.p$)(s))}),[s,i]),b=r.useCallback((function(e){const t=((e=[])=>{const t=[],n=function(e,r){t.push(e),(e.children||[]).forEach((t=>n(t,e.id)))};return e.forEach((e=>n(e,""))),t})(s);let n=t.find((t=>t.id===e));for(;n?.parentId;)n=t.find((e=>e.id===n?.parentId)),n&&(n.isAuth=!0);i((0,w.p$)(s))}),[s,i]),O=r.useCallback((function(e,t){const n=function(t){t.isAuth=e,t.buttonList?.forEach((t=>{t.isAuth=e})),t.children?.forEach((e=>{n(e)}))};e&&b(t.id),n(t),i((0,w.p$)(s))}),[b,i,s]),E=r.useCallback((function(e){(e.buttonList||[]).some((e=>!0===e.isAuth))&&(e.isAuth=!0,b(e.id)),i((0,w.p$)(s))}),[b,i,s]),[A,F]=(0,P.ZP)(!1),N=r.useCallback((function(){F.setTrue();const t=(0,I.ff)(s,(e=>({id:e.id,isAuth:e.isAuth})));return(0,S.fs)(t).then((()=>{l(!1),e.callback(),a.success("更新成功！")})).finally((()=>F.setFalse()))}),[s,a,e,l,F]),z=[{title:"名称",dataIndex:"title"},{title:"类型",dataIndex:"type",render:e=>{const t=$.menuType.map[e];return(0,m.jsx)(C.Z,{color:t.color,children:t.label})},type:"select",options:$.menuType.options},{title:"按钮",dataIndex:"buttonList",render:(e,t)=>e?.map((e=>(0,m.jsx)(k.Z,{checked:e.isAuth,onChange:n=>{e.isAuth=n.target.checked,E(t)},children:e.name},e.id)))},{title:(0,m.jsx)(k.Z,{checked:u,indeterminate:h,onChange:e=>g(e.target.checked)}),key:"action",render:e=>(0,m.jsx)(k.Z,{checked:e.isAuth,onChange:t=>O(t.target.checked,e)})}];return r.useImperativeHandle(t,(()=>({start:e=>{d(e),l(!0)}}))),(0,m.jsx)(y.Z,{title:"角色授权",width:800,open:n,centered:!0,wrapClassName:"custom-modal-style",maskClosable:!1,onOk:()=>N(),onCancel:()=>l(!1),confirmLoading:A,okText:"保存",children:(0,m.jsx)(x.Z,{rowKey:"id",size:"small",dataSource:s,columns:z,loading:c,pagination:!1,bordered:!0})})}));var A=(0,f.Z)(E,{useModal:function(e){const t=r.useRef(null);return[t,(0,m.jsx)(E,{ref:t,...e})]}}),F=n(63953);function N(){const{modal:e,message:t}=o.Z.useApp(),n=(0,r.useRef)(null),[d,u]=b.useModal({callback:e=>n.current?.refresh(e)}),[p,h]=A.useModal({callback:()=>n.current?.refresh()}),[f,g]=(0,F.Fu)({render:e=>(0,m.jsx)(l.ZP,{type:"primary",ghost:!0,size:"small",onClick:()=>d.current?.editStart(e),children:"编辑"}),permission:"edit"},{render:e=>(0,m.jsx)(l.ZP,{type:"primary",size:"small",style:{background:"#e6a23c"},onClick:()=>p.current?.start(e.id),children:"授权"}),permission:"accredit"},{render:r=>(0,m.jsx)(l.ZP,{type:"primary",danger:!0,size:"small",onClick:()=>e.confirm({title:"提示",content:"确定要删除此角色吗？",okType:"danger",onOk:()=>(0,S.l5)(r.id).then((()=>{t.success("删除成功！"),n.current?.refresh()})),centered:!0}),children:"删除"}),permission:"del"}),C=[{title:"角色名称",dataIndex:"roleName"},{title:"备注",dataIndex:"description",hideInSearch:!0},{title:"状态",dataIndex:"status",render:(e,n)=>{const{enabled:r,disabled:o}=$.roleEnabledState.enum;return(0,m.jsx)(i.Z,{defaultChecked:e===r,onChange:e=>(0,S.GG)(n.id,e?r:o).then((()=>{t.success("切换成功！")}))})},type:"select",options:$.roleEnabledState.options},{title:"创建时间",dataIndex:"createTime",hideInSearch:!0},{title:"操作",key:"action",render:e=>(0,m.jsx)(a.Z,{children:f(e)}),width:100,fixed:"right",hideInSearch:!0,hideInTable:!g}];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.Z,{ref:n,columns:C,rowKey:"id",headerTitle:"角色列表",request:(e,{current:t,pageSize:n})=>(0,S.JV)(e,t,n).then((e=>{const{result:t}=e;return{list:t.records,total:t.total}})),toolBarRender:()=>(0,m.jsx)(F.ZP,{permission:"add",children:(0,m.jsx)(l.ZP,{type:"primary",icon:(0,m.jsx)(s.Z,{}),onClick:()=>d.current?.addStart(),children:"新增"})})}),u,h]})}},16509:function(e,t,n){n.d(t,{Z:function(){return I}});var r=n(89526),o=n(70854),l=n.n(o),a=n(61370),s=n(50159),c=n(73591),i=n(42514),d=n(89651),u=n(25342),p=n(13806),h=n(13728),f=n(11351),m=n(94237),g=n(55439);const b=e=>{const{lineWidth:t,fontSizeIcon:n,calc:r}=e,o=e.fontSizeSM;return(0,m.TS)(e,{tagFontSize:o,tagLineHeight:(0,p.bf)(r(e.lineHeightSM).mul(o).equal()),tagIconSize:r(n).sub(r(t).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},C=e=>({defaultBg:new h.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var k=(0,g.I$)("Tag",(e=>(e=>{const{paddingXXS:t,lineWidth:n,tagPaddingHorizontal:r,componentCls:o,calc:l}=e,a=l(r).sub(n).equal(),s=l(t).sub(n).equal();return{[o]:Object.assign(Object.assign({},(0,f.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:a,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,p.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${o}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${o}-close-icon`]:{marginInlineStart:s,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${o}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${o}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:a}}),[`${o}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}})(b(e))),C);const y=r.forwardRef(((e,t)=>{const{prefixCls:n,style:o,className:a,checked:s,onChange:c,onClick:i}=e,d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:p,tag:h}=r.useContext(u.E_),f=p("tag",n),[m,g,b]=k(f),C=l()(f,`${f}-checkable`,{[`${f}-checkable-checked`]:s},null==h?void 0:h.className,a,g,b);return m(r.createElement("span",Object.assign({},d,{ref:t,style:Object.assign(Object.assign({},o),null==h?void 0:h.style),className:C,onClick:e=>{null==c||c(!s),null==i||i(e)}})))}));var x=y,Z=n(7606),v=(0,g.bk)(["Tag","preset"],(e=>(e=>(0,Z.Z)(e,((t,n)=>{let{textColor:r,lightBorderColor:o,lightColor:l,darkColor:a}=n;return{[`${e.componentCls}${e.componentCls}-${t}`]:{color:r,background:l,borderColor:o,"&-inverse":{color:e.colorTextLightSolid,background:a,borderColor:a},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}})))(b(e))),C);const j=(e,t,n)=>{const r="string"!=typeof(o=n)?o:o.charAt(0).toUpperCase()+o.slice(1);var o;return{[`${e.componentCls}${e.componentCls}-${t}`]:{color:e[`color${n}`],background:e[`color${r}Bg`],borderColor:e[`color${r}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var S=(0,g.bk)(["Tag","status"],(e=>{const t=b(e);return[j(t,"success","Success"),j(t,"processing","Info"),j(t,"error","Error"),j(t,"warning","Warning")]}),C);const $=r.forwardRef(((e,t)=>{const{prefixCls:n,className:o,rootClassName:p,style:h,children:f,icon:m,color:g,onClose:b,bordered:C=!0,visible:y}=e,x=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:Z,direction:j,tag:$}=r.useContext(u.E_),[w,I]=r.useState(!0),P=(0,a.Z)(x,["closeIcon","closable"]);r.useEffect((()=>{void 0!==y&&I(y)}),[y]);const O=(0,s.o2)(g),T=(0,s.yT)(g),E=O||T,A=Object.assign(Object.assign({backgroundColor:g&&!E?g:void 0},null==$?void 0:$.style),h),F=Z("tag",n),[N,z,B]=k(F),R=l()(F,null==$?void 0:$.className,{[`${F}-${g}`]:E,[`${F}-has-color`]:g&&!E,[`${F}-hidden`]:!w,[`${F}-rtl`]:"rtl"===j,[`${F}-borderless`]:!C},o,p,z,B),H=e=>{e.stopPropagation(),null==b||b(e),e.defaultPrevented||I(!1)},[,L]=(0,c.Z)((0,c.w)(e),(0,c.w)($),{closable:!1,closeIconRender:e=>{const t=r.createElement("span",{className:`${F}-close-icon`,onClick:H},e);return(0,i.wm)(e,t,(e=>({onClick:t=>{var n;null===(n=null==e?void 0:e.onClick)||void 0===n||n.call(e,t),H(t)},className:l()(null==e?void 0:e.className,`${F}-close-icon`)})))}}),M="function"==typeof x.onClick||f&&"a"===f.type,q=m||null,_=q?r.createElement(r.Fragment,null,q,f&&r.createElement("span",null,f)):f,V=r.createElement("span",Object.assign({},P,{ref:t,className:R,style:A}),_,L,O&&r.createElement(v,{key:"preset",prefixCls:F}),T&&r.createElement(S,{key:"status",prefixCls:F}));return N(M?r.createElement(d.Z,{component:"Tag"},V):V)})),w=$;w.CheckableTag=x;var I=w}}]);
//# sourceMappingURL=674.42a9bac0.chunk.js.map