"use strict";(self.webpackChunkreact_admin_web=self.webpackChunkreact_admin_web||[]).push([[938],{27366:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var o=n(72816),i=n(96799),r=n(74918),l=n(97132),a=n(25877),s=n(58047),c=n(67987),d=n(63953),p=n(89526),u=n(5416),m=n(9740),f=n(57503),g=n(10011),h=n(53139),b=n(91117),y=n(95267),v=n(49839),x=n(20485),$=n(67557);const I={id:"",parentId:void 0,deptName:"",description:""},j=function(e){const{message:t}=o.Z.useApp(),[n]=u.Z.useForm(),l=u.Z.useWatch("id",n),{data:a}=(0,c.uD)(),[s]=(0,c.SF)(),[d]=(0,c.Bz)(),v=p.useCallback((()=>n.setFieldsValue({...I,...e.initialValues})),[n,e.initialValues]);p.useEffect((()=>v()),[v]);const[x,j]=(0,y.ZP)(!1);return(0,$.jsx)(m.Z,{title:l?"编辑":"新增",width:800,open:e.visible,centered:!0,wrapClassName:"custom-modal-style",maskClosable:!1,footer:(0,$.jsxs)(r.Z,{children:[(0,$.jsx)(i.ZP,{onClick:()=>{e.onClose?.(),v()},children:"取消"}),(0,$.jsx)(i.ZP,{type:"primary",loading:x,onClick:()=>n.submit(),children:"确定"})]}),onCancel:()=>e.onClose?.(),children:(0,$.jsxs)(u.Z,{form:n,layout:"vertical",autoComplete:"off",onFinish:n=>{const o=l?d:s,i=l?"更新成功！":"新增成功！";j.setTrue(),o(n).unwrap().then((()=>{t.success(i),e.onClose?.()})).finally((()=>{j.setFalse()}))},initialValues:I,children:[(0,$.jsx)(u.Z.Item,{name:"id",hidden:!0,children:(0,$.jsx)(f.Z,{})}),(0,$.jsxs)(g.Z,{gutter:16,children:[(0,$.jsx)(h.Z,{span:12,children:(0,$.jsx)(u.Z.Item,{label:"父节点",name:"parentId",required:!0,children:(0,$.jsx)(b.Z,{treeData:a,placeholder:"根节点",disabled:!0})})}),(0,$.jsx)(h.Z,{span:12,children:(0,$.jsx)(u.Z.Item,{name:"deptName",label:"部门名称",rules:[{required:!0,message:"请填写部门名称"}],children:(0,$.jsx)(f.Z,{placeholder:"请输入"})})}),(0,$.jsx)(h.Z,{span:24,children:(0,$.jsx)(u.Z.Item,{name:"description",label:"备注",children:(0,$.jsx)(f.Z.TextArea,{placeholder:"请输入"})})})]})]})})};var w=(0,v.Z)(j,{ManagedModal:function(e){const[t,{set:n}]=(0,x.Z)(!1);return(0,$.jsxs)($.Fragment,{children:[e.content(n),(0,$.jsx)(j,{visible:t,initialValues:e.initialValues,onClose:()=>n(!1)})]})}});function C(){const{modal:e,message:t}=o.Z.useApp(),{data:n,isFetching:p,refetch:u}=(0,c.EY)(),[m]=(0,c.NY)(),[f,g]=(0,d.Fu)({render:e=>(0,$.jsx)(w.ManagedModal,{content:e=>(0,$.jsx)(i.ZP,{type:"primary",ghost:!0,size:"small",onClick:()=>e(!0),children:"编辑"}),initialValues:{id:e.id,parentId:e.parentId,deptName:e.deptName,description:e.description}},e.id),permission:"edit"},{render:e=>(0,$.jsx)(w.ManagedModal,{content:e=>(0,$.jsx)(i.ZP,{type:"primary",size:"small",onClick:()=>e(!0),children:"新增下级"}),initialValues:{parentId:e.id}}),permission:"add"},{render:n=>(0,$.jsx)(i.ZP,{type:"primary",danger:!0,size:"small",onClick:()=>e.confirm({title:"提示",content:"您确定要删除此部门及其子部门吗？",okType:"danger",onOk:()=>{return e=n.id,void m({id:e}).unwrap().then((()=>{t.success("删除成功！")}));var e},centered:!0}),children:"删除"}),permission:"del"}),h=[{title:"部门名称",dataIndex:"deptName"},{title:"备注",dataIndex:"description"},{title:"操作",key:"action",render:e=>(0,$.jsx)(r.Z,{children:f(e)}),width:100,fixed:"right",hideInTable:!g}],[b]=(0,d.Fu)({render:()=>(0,$.jsx)(w.ManagedModal,{content:e=>(0,$.jsx)(i.ZP,{type:"primary",icon:(0,$.jsx)(s.Z,{}),onClick:()=>e(!0),children:"新增"})},"add"),permission:"add"},{render:()=>(0,$.jsx)(i.ZP,{onClick:()=>t.warning("演示功能"),children:"导出"}),permission:"export"}),[y,v]=(0,d.Fu)({render:()=>(0,$.jsx)(i.ZP,{type:"primary",danger:!0,onClick:()=>t.warning("演示功能"),children:"批量删除"}),permission:"del"},{render:()=>(0,$.jsx)(i.ZP,{onClick:()=>t.warning("演示功能"),children:"导出数据"},"export"),permission:"export"});return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(l.Z,{message:"此页面用redux管理数据，主要用来演示和体验RTK查询的功能",type:"info",showIcon:!0,closable:!0}),(0,$.jsx)(a.Z,{rowKey:"id",columns:h,dataSource:n,headerTitle:"部门列表",loading:p,search:!1,onRefresh:u,toolBarRender:b(),batchBarRender:v?y():void 0})]})}},67987:function(e,t,n){n.d(t,{Bz:function(){return c},EY:function(){return l},NY:function(){return d},SF:function(){return s},uD:function(){return a}});const o=n(50158).Z.enhanceEndpoints({addTagTypes:["deptList","deptSelect"]}),i=(e=[],t)=>e.filter((e=>e.id!==t)).map((({children:e=[],...n})=>({...n,children:e.length?i(e,t):void 0}))),r=o.injectEndpoints({endpoints:e=>({getDeptAll:e.query({query:()=>"/api/dept/all",providesTags:["deptList"]}),getDeptSelect:e.query({query:()=>"/api/dept/select",providesTags:["deptSelect"]}),addDeptItem:e.mutation({query:e=>({url:"/api/dept/add",method:"POST",body:e}),invalidatesTags:["deptList","deptSelect"]}),updateDeptItem:e.mutation({query:e=>({url:"/api/dept/update",method:"POST",body:e}),invalidatesTags:["deptList","deptSelect"]}),deleteDeptItem:e.mutation({query:e=>({url:"/api/dept/delete",method:"POST",body:e}),invalidatesTags:["deptList","deptSelect"],async onQueryStarted({id:e},{dispatch:t,queryFulfilled:n}){const o=t(r.util.updateQueryData("getDeptAll",void 0,(t=>i(t,e))));try{await n}catch{o.undo()}}})})}),{useGetDeptAllQuery:l,useGetDeptSelectQuery:a,useAddDeptItemMutation:s,useUpdateDeptItemMutation:c,useDeleteDeptItemMutation:d}=r},97132:function(e,t,n){n.d(t,{Z:function(){return D}});var o=n(89526),i=n(4797),r=n(23835),l=n(17431),a=n(79255),s=n(39673),c=n(70854),d=n.n(c),p=n(93342),u=n(64300),m=n(8786),f=n(42514),g=n(25342),h=n(13806),b=n(11351),y=n(55439);const v=(e,t,n,o,i)=>({background:e,border:`${(0,h.bf)(o.lineWidth)} ${o.lineType} ${t}`,[`${i}-icon`]:{color:n}}),x=e=>{const{componentCls:t,motionDurationSlow:n,marginXS:o,marginSM:i,fontSize:r,fontSizeLG:l,lineHeight:a,borderRadiusLG:s,motionEaseInOutCirc:c,withDescriptionIconSize:d,colorText:p,colorTextHeading:u,withDescriptionPadding:m,defaultPadding:f}=e;return{[t]:Object.assign(Object.assign({},(0,b.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:f,wordWrap:"break-word",borderRadius:s,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:o,lineHeight:0},"&-description":{display:"none",fontSize:r,lineHeight:a},"&-message":{color:u},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${c}, opacity ${n} ${c},\n        padding-top ${n} ${c}, padding-bottom ${n} ${c},\n        margin-bottom ${n} ${c}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${t}-with-description`]:{alignItems:"flex-start",padding:m,[`${t}-icon`]:{marginInlineEnd:i,fontSize:d,lineHeight:0},[`${t}-message`]:{display:"block",marginBottom:o,color:u,fontSize:l},[`${t}-description`]:{display:"block",color:p}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},$=e=>{const{componentCls:t,colorSuccess:n,colorSuccessBorder:o,colorSuccessBg:i,colorWarning:r,colorWarningBorder:l,colorWarningBg:a,colorError:s,colorErrorBorder:c,colorErrorBg:d,colorInfo:p,colorInfoBorder:u,colorInfoBg:m}=e;return{[t]:{"&-success":v(i,o,n,e,t),"&-info":v(m,u,p,e,t),"&-warning":v(a,l,r,e,t),"&-error":Object.assign(Object.assign({},v(d,c,s,e,t)),{[`${t}-description > pre`]:{margin:0,padding:0}})}}},I=e=>{const{componentCls:t,iconCls:n,motionDurationMid:o,marginXS:i,fontSizeIcon:r,colorIcon:l,colorIconHover:a}=e;return{[t]:{"&-action":{marginInlineStart:i},[`${t}-close-icon`]:{marginInlineStart:i,padding:0,overflow:"hidden",fontSize:r,lineHeight:(0,h.bf)(r),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:l,transition:`color ${o}`,"&:hover":{color:a}}},"&-close-text":{color:l,transition:`color ${o}`,"&:hover":{color:a}}}}};var j=(0,y.I$)("Alert",(e=>[x(e),$(e),I(e)]),(e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`}))),w=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n};const C={success:i.Z,info:s.Z,error:r.Z,warning:a.Z},S=e=>{const{icon:t,prefixCls:n,type:i}=e,r=C[i]||null;return t?(0,f.wm)(t,o.createElement("span",{className:`${n}-icon`},t),(()=>({className:d()(`${n}-icon`,{[t.props.className]:t.props.className})}))):o.createElement(r,{className:`${n}-icon`})},Z=e=>{const{isClosable:t,prefixCls:n,closeIcon:i,handleClose:r,ariaProps:a}=e,s=!0===i||void 0===i?o.createElement(l.Z,null):i;return t?o.createElement("button",Object.assign({type:"button",onClick:r,className:`${n}-close-icon`,tabIndex:0},a),s):null},O=o.forwardRef(((e,t)=>{const{description:n,prefixCls:i,message:r,banner:l,className:a,rootClassName:s,style:c,onMouseEnter:f,onMouseLeave:h,onClick:b,afterClose:y,showIcon:v,closable:x,closeText:$,closeIcon:I,action:C,id:O}=e,E=w(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[P,k]=o.useState(!1),M=o.useRef(null);o.useImperativeHandle(t,(()=>({nativeElement:M.current})));const{getPrefixCls:N,direction:z,alert:T}=o.useContext(g.E_),B=N("alert",i),[D,H,W]=j(B),L=t=>{var n;k(!0),null===(n=e.onClose)||void 0===n||n.call(e,t)},A=o.useMemo((()=>void 0!==e.type?e.type:l?"warning":"info"),[e.type,l]),F=o.useMemo((()=>!("object"!=typeof x||!x.closeIcon)||!!$||("boolean"==typeof x?x:!1!==I&&null!=I||!!(null==T?void 0:T.closable))),[$,I,x,null==T?void 0:T.closable]),q=!(!l||void 0!==v)||v,G=d()(B,`${B}-${A}`,{[`${B}-with-description`]:!!n,[`${B}-no-icon`]:!q,[`${B}-banner`]:!!l,[`${B}-rtl`]:"rtl"===z},null==T?void 0:T.className,a,s,W,H),R=(0,m.Z)(E,{aria:!0,data:!0}),V=o.useMemo((()=>{var e,t;return"object"==typeof x&&x.closeIcon?x.closeIcon:$||(void 0!==I?I:"object"==typeof(null==T?void 0:T.closable)&&(null===(e=null==T?void 0:T.closable)||void 0===e?void 0:e.closeIcon)?null===(t=null==T?void 0:T.closable)||void 0===t?void 0:t.closeIcon:null==T?void 0:T.closeIcon)}),[I,x,$,null==T?void 0:T.closeIcon]),_=o.useMemo((()=>{const e=null!=x?x:null==T?void 0:T.closable;if("object"==typeof e){const{closeIcon:t}=e;return w(e,["closeIcon"])}return{}}),[x,null==T?void 0:T.closable]);return D(o.createElement(p.ZP,{visible:!P,motionName:`${B}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:y},((t,i)=>{let{className:l,style:a}=t;return o.createElement("div",Object.assign({id:O,ref:(0,u.sQ)(M,i),"data-show":!P,className:d()(G,l),style:Object.assign(Object.assign(Object.assign({},null==T?void 0:T.style),c),a),onMouseEnter:f,onMouseLeave:h,onClick:b,role:"alert"},R),q?o.createElement(S,{description:n,icon:e.icon,prefixCls:B,type:A}):null,o.createElement("div",{className:`${B}-content`},r?o.createElement("div",{className:`${B}-message`},r):null,n?o.createElement("div",{className:`${B}-description`},n):null),C?o.createElement("div",{className:`${B}-action`},C):null,o.createElement(Z,{isClosable:F,prefixCls:B,closeIcon:V,handleClose:L,ariaProps:_}))})))}));var E=O,P=n(83493),k=n(28141),M=n(2885),N=n(75016);let z=function(e){function t(){var e;return(0,P.Z)(this,t),(e=(0,M.Z)(this,t,arguments)).state={error:void 0,info:{componentStack:""}},e}return(0,N.Z)(t,e),(0,k.Z)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){const{message:e,description:t,id:n,children:i}=this.props,{error:r,info:l}=this.state,a=l&&l.componentStack?l.componentStack:null,s=void 0===e?(r||"").toString():e,c=void 0===t?a:t;return r?o.createElement(E,{id:n,type:"error",message:s,description:o.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},c)}):i}}])}(o.Component);var T=z;const B=E;B.ErrorBoundary=T;var D=B},53139:function(e,t,n){var o=n(78944);t.Z=o.Z},84878:function(e,t,n){n.d(t,{Z:function(){return m}});var o=n(89526),i=n(70854),r=n.n(i),l=n(25342),a=n(13806),s=n(11351),c=n(55439),d=n(94237);const p=e=>{const{componentCls:t,sizePaddingEdgeHorizontal:n,colorSplit:o,lineWidth:i,textPaddingInline:r,orientationMargin:l,verticalMarginInline:c}=e;return{[t]:Object.assign(Object.assign({},(0,s.Wf)(e)),{borderBlockStart:`${(0,a.bf)(i)} solid ${o}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:c,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${(0,a.bf)(i)} solid ${o}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${(0,a.bf)(e.dividerHorizontalGutterMargin)} 0`},[`&-horizontal${t}-with-text`]:{display:"flex",alignItems:"center",margin:`${(0,a.bf)(e.dividerHorizontalWithTextGutterMargin)} 0`,color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${o}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${(0,a.bf)(i)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${t}-with-text-left`]:{"&::before":{width:`calc(${l} * 100%)`},"&::after":{width:`calc(100% - ${l} * 100%)`}},[`&-horizontal${t}-with-text-right`]:{"&::before":{width:`calc(100% - ${l} * 100%)`},"&::after":{width:`calc(${l} * 100%)`}},[`${t}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:r},"&-dashed":{background:"none",borderColor:o,borderStyle:"dashed",borderWidth:`${(0,a.bf)(i)} 0 0`},[`&-horizontal${t}-with-text${t}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${t}-dashed`]:{borderInlineStartWidth:i,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${t}-with-text`]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize},[`&-horizontal${t}-with-text-left${t}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${t}-inner-text`]:{paddingInlineStart:n}},[`&-horizontal${t}-with-text-right${t}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${t}-inner-text`]:{paddingInlineEnd:n}}})}};var u=(0,c.I$)("Divider",(e=>{const t=(0,d.TS)(e,{dividerHorizontalWithTextGutterMargin:e.margin,dividerHorizontalGutterMargin:e.marginLG,sizePaddingEdgeHorizontal:0});return[p(t)]}),(e=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:e.marginXS})),{unitless:{orientationMargin:!0}}),m=e=>{const{getPrefixCls:t,direction:n,divider:i}=o.useContext(l.E_),{prefixCls:a,type:s="horizontal",orientation:c="center",orientationMargin:d,className:p,rootClassName:m,children:f,dashed:g,plain:h,style:b}=e,y=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}(e,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","plain","style"]),v=t("divider",a),[x,$,I]=u(v),j=c.length>0?`-${c}`:c,w=!!f,C="left"===c&&null!=d,S="right"===c&&null!=d,Z=r()(v,null==i?void 0:i.className,$,I,`${v}-${s}`,{[`${v}-with-text`]:w,[`${v}-with-text${j}`]:w,[`${v}-dashed`]:!!g,[`${v}-plain`]:!!h,[`${v}-rtl`]:"rtl"===n,[`${v}-no-default-orientation-margin-left`]:C,[`${v}-no-default-orientation-margin-right`]:S},p,m),O=o.useMemo((()=>"number"==typeof d?d:/^\d+$/.test(d)?Number(d):d),[d]),E=Object.assign(Object.assign({},C&&{marginLeft:O}),S&&{marginRight:O});return x(o.createElement("div",Object.assign({className:Z,style:Object.assign(Object.assign({},null==i?void 0:i.style),b)},y,{role:"separator"}),f&&"vertical"!==s&&o.createElement("span",{className:`${v}-inner-text`,style:E},f)))}},9740:function(e,t,n){n.d(t,{Z:function(){return x}});var o=n(97839),i=n(48570),r=n(26806),l=n(89526),a=n(70854),s=n.n(a),c=n(68334),d=n(74425),p=n(25342),u=n(88132),m=n(76678),f=n(76934),g=n(33874),h=(0,d.i)((e=>{const{prefixCls:t,className:n,closeIcon:o,closable:i,type:r,title:a,children:d,footer:h}=e,b=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:y}=l.useContext(p.E_),v=y(),x=t||y("modal"),$=(0,u.Z)(v),[I,j,w]=(0,g.ZP)(x,$),C=`${x}-confirm`;let S={};return S=r?{closable:null!=i&&i,title:"",footer:"",children:l.createElement(m.O,Object.assign({},e,{prefixCls:x,confirmPrefixCls:C,rootPrefixCls:v,content:d}))}:{closable:null==i||i,title:a,footer:null!==h&&l.createElement(f.$,Object.assign({},e)),children:d},I(l.createElement(c.s,Object.assign({prefixCls:x,className:s()(j,`${x}-pure-panel`,r&&C,r&&`${C}-${r}`,n,w,$)},b,{closeIcon:(0,f.b)(x,o),closable:i},S)))})),b=n(4894);function y(e){return(0,o.ZP)((0,o.uW)(e))}const v=r.Z;v.useModal=b.Z,v.info=function(e){return(0,o.ZP)((0,o.cw)(e))},v.success=function(e){return(0,o.ZP)((0,o.vq)(e))},v.error=function(e){return(0,o.ZP)((0,o.AQ)(e))},v.warning=y,v.warn=y,v.confirm=function(e){return(0,o.ZP)((0,o.Au)(e))},v.destroyAll=function(){for(;i.Z.length;){const e=i.Z.pop();e&&e()}},v.config=o.ai,v._InternalPanelDoNotUseOrYouWillBeFired=h;var x=v},10011:function(e,t,n){var o=n(1308);t.Z=o.Z}}]);
//# sourceMappingURL=938.a5243e0d.chunk.js.map