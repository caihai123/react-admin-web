"use strict";(self.webpackChunkreact_admin_web=self.webpackChunkreact_admin_web||[]).push([[626],{10427:function(e,n,r){var t=r(54374),o=r(53725),l=r(68347),a=r(67557);const s=l;n.Z=function(e){const{dictName:n,placeholder:r="请选择",...l}=e,{options:i}=s[n];return(0,a.jsx)(t.default,{...l,placeholder:r,children:i.map((e=>(0,a.jsx)(t.default.Option,{value:e.value,children:e.color?(0,a.jsx)(o.Z,{color:e.color,text:e.label}):e.label},e.value)))})}},97344:function(e,n,r){r.d(n,{Z:function(){return S}});var t=r(89526),o=r(20485),l=r(97839),a=r(48570),s=r(26806),i=r(70854),c=r.n(i),d=r(68334),u=r(74425),p=r(25342),m=r(89134),f=r(76934),h=r(33874),g=r(88132),b=(0,u.i)((e=>{const{prefixCls:n,className:r,closeIcon:o,closable:l,type:a,title:s,children:i,footer:u}=e,b=function(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(r[t[o]]=e[t[o]])}return r}(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:x}=t.useContext(p.E_),y=x(),C=n||x("modal"),Z=(0,g.Z)(y),[j,v,k]=(0,h.ZP)(C,Z),O=`${C}-confirm`;let $={};return $=a?{closable:null!=l&&l,title:"",footer:"",children:t.createElement(m.O,Object.assign({},e,{prefixCls:C,confirmPrefixCls:O,rootPrefixCls:y,content:i}))}:{closable:null==l||l,title:s,footer:null!==u&&t.createElement(f.$,Object.assign({},e)),children:i},j(t.createElement(d.s,Object.assign({prefixCls:C,className:c()(v,`${C}-pure-panel`,a&&O,a&&`${O}-${a}`,r,k,Z)},b,{closeIcon:(0,f.b)(C,o),closable:l},$)))})),x=r(4894);function y(e){return(0,l.ZP)((0,l.uW)(e))}const C=s.Z;C.useModal=x.Z,C.info=function(e){return(0,l.ZP)((0,l.cw)(e))},C.success=function(e){return(0,l.ZP)((0,l.vq)(e))},C.error=function(e){return(0,l.ZP)((0,l.AQ)(e))},C.warning=y,C.warn=y,C.confirm=function(e){return(0,l.ZP)((0,l.Au)(e))},C.destroyAll=function(){for(;a.Z.length;){const e=a.Z.pop();e&&e()}},C.config=l.ai,C._InternalPanelDoNotUseOrYouWillBeFired=b;var Z=C,j=r(74918),v=r(96799),k=r(5416),O=r(95267),$=r(49839),I=r(67557);const P=(0,t.forwardRef)((function(e,n){const{title:r,width:l,submitText:a="确定",cancelText:s="取消",children:i,modalProps:c,formProps:d,onFinish:u,footer:p,initialValues:m,afterClose:f}=e,[h,{set:g}]=(0,o.Z)(!1),[b,x]=(0,O.ZP)(!1);return(0,t.useImperativeHandle)(n,(()=>({open:()=>g(!0),close:()=>g(!1)}))),(0,I.jsx)(Z,{title:r,open:h,onCancel:()=>g(!1),width:l,footer:p||(0,I.jsxs)(j.Z,{children:[(0,I.jsx)(v.ZP,{onClick:()=>g(!1),children:s}),(0,I.jsx)(v.ZP,{type:"primary",loading:b,onClick:()=>e.form?.submit(),children:a})]}),centered:!0,wrapClassName:"custom-modal-style",maskClosable:!1,afterClose:f,...c,children:(0,I.jsx)(k.Z,{form:e.form,autoComplete:"off",onFinish:e=>{const n=u?.(e);n instanceof Promise&&(x.setTrue(),n.then((()=>g(!1))).finally((()=>x.setFalse())))},layout:"vertical",initialValues:m,...d,children:i})})}));var S=(0,$.Z)(P,{useModal:function(e){const n=(0,t.useRef)(null),[r]=k.Z.useForm();return[n,r,(0,I.jsx)(P,{ref:n,form:r,...e})]}})},49839:function(e,n,r){function t(e,n){const r=e;return Object.keys(n).forEach((e=>{Object.defineProperty(r,e,{value:n[e],writable:!1,enumerable:!0})})),r}r.d(n,{Z:function(){return t}})},79155:function(e,n,r){r.r(n),r.d(n,{default:function(){return N}});var t=r(89526),o=r(72816),l=r(96799),a=r(24059),s=r(16509),i=r(74918),c=r(31363),d=r(25877),u=r(60561),p=r(58047),m=r(68347),f=r(95694);const h=()=>f.Z.get("/api/menu/all"),g=e=>f.Z.post("/api/menu/remove",{id:e});var b=r(63953),x=r(5416),y=r(10011),C=r(53139),Z=r(91117),j=r(97344),v=r(10427),k=r(49839),O=r(17431);const $={pattern:/^\/[\w-/]*$/,message:"必须以斜杠开头，后跟字母、数字、下划线、中划线或斜杠"},I={pattern:/^[a-z][a-z0-9-]*$/,message:"只能是小写字母、中划线和数字组成，且必须以字母开头"};var P=r(67557);const S=t.forwardRef(((e,n)=>{const{message:r}=o.Z.useApp(),[a,s]=t.useState(""),d=t.useRef(null),[u]=x.Z.useForm(),p=x.Z.useWatch("type",u);return t.useImperativeHandle(n,(()=>({addStart:e=>{u.setFieldValue("parentId",e),d.current?.open()},editStart:e=>{s(e.id),u.setFieldsValue(e),d.current?.open()}}))),(0,P.jsxs)(j.Z,{ref:d,form:u,title:a?"编辑":"新增",width:800,afterClose:()=>{s(""),u.resetFields()},initialValues:{type:m.menuType.enum.menu},onFinish:n=>{const t=a?"/api/menu/update":"/api/menu/add",o=a?"更新成功！":"新增成功！",l=a?{id:a,...n}:n;return f.Z.post(t,l).then((()=>{r.success(o),e.callback(!a)}))},children:[(0,P.jsxs)(y.Z,{gutter:16,children:[(0,P.jsx)(C.Z,{span:12,children:(0,P.jsx)(x.Z.Item,{label:"父节点",name:"parentId",required:!0,children:(0,P.jsx)(Z.Z,{treeData:e.menuTreeAll,fieldNames:{label:"title",value:"id"},placeholder:"根节点",disabled:!0})})}),(0,P.jsx)(C.Z,{span:12,children:(0,P.jsx)(x.Z.Item,{label:"名称",name:"title",rules:[{required:!0},{type:"string",min:2,max:10,message:"长度在 2 到 10 个字符！"}],children:(0,P.jsx)(c.Z,{placeholder:"菜单名称"})})}),(0,P.jsx)(C.Z,{span:12,children:(0,P.jsx)(x.Z.Item,{label:"类型",name:"type",rules:[{required:!0}],children:(0,P.jsx)(v.Z,{placeholder:"菜单类型",dictName:"menuType"})})}),p===m.menuType.enum.menu&&(0,P.jsx)(C.Z,{span:12,children:(0,P.jsx)(x.Z.Item,{label:"路径",name:"path",rules:[{required:!0},$],children:(0,P.jsx)(c.Z,{placeholder:"菜单路径"})})}),(0,P.jsx)(C.Z,{span:12,children:(0,P.jsx)(x.Z.Item,{label:"图标",name:"icon",children:(0,P.jsx)(c.Z,{placeholder:"图标名称"})})})]}),p===m.menuType.enum.menu&&(0,P.jsx)(y.Z,{gutter:16,children:(0,P.jsx)(C.Z,{span:12,children:(0,P.jsx)(x.Z.Item,{label:"按钮",children:(0,P.jsx)(x.Z.List,{name:"buttonList",children:(e,n)=>(0,P.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[e.map((({key:e,name:r})=>(0,P.jsxs)(i.Z,{align:"baseline",children:[(0,P.jsx)(x.Z.Item,{name:[r,"name"],rules:[{required:!0,message:"按钮名称是必选字段"}],children:(0,P.jsx)(c.Z,{placeholder:"按钮名称"})}),(0,P.jsx)(x.Z.Item,{name:[r,"id"],rules:[{required:!0,message:"按钮标识是必选字段"},I],children:(0,P.jsx)(c.Z,{placeholder:"按钮标识"})}),(0,P.jsx)(O.Z,{onClick:()=>n.remove(r)})]},e))),(0,P.jsx)(l.ZP,{type:"dashed",onClick:()=>n.add(),block:!0,children:"+ 新增按钮"})]})})})})})]})}));var w=(0,k.Z)(S,{useModal:function(e){const n=t.useRef(null);return[n,(0,P.jsx)(S,{ref:n,...e})]}}),T=r(88238),E=r(22701);function N(){const{modal:e,message:n}=o.Z.useApp(),{data:r,loading:f,refresh:x}=(0,T.Z)((async()=>(await h()).result)),[y,C]=t.useState(),Z=t.useMemo((()=>y?(0,E.Zm)(r,(e=>e.title.toLowerCase().includes(y.toLowerCase()))):r),[r,y]),[j,v]=w.useModal({menuTreeAll:r,callback:e=>{x(),e&&C(void 0)}}),[k,O]=(0,b.Fu)({render:e=>(0,P.jsx)(l.ZP,{type:"primary",ghost:!0,size:"small",onClick:()=>j.current?.editStart(e),children:"编辑"}),permission:"edit"},{render:e=>(0,P.jsx)(l.ZP,{type:"primary",size:"small",onClick:()=>j.current?.addStart(e.id),children:"新增下级"}),permission:"add"},{render:r=>(0,P.jsx)(l.ZP,{type:"primary",danger:!0,size:"small",onClick:()=>e.confirm({title:"提示",content:"确定要删除此菜单及其子菜单吗？",okType:"danger",onOk:()=>g(r.id).then((()=>n.success("删除成功！"))),centered:!0}),children:"删除"}),permission:"del"}),{token:{colorError:$}}=a.Z.useToken(),I=t.useCallback((function(e,n){if(!n)return e;const r=new RegExp(`(${n})`,"gi");return e.replace(r,`<span style="color:${$}">$1</span>`)}),[$]),S=[{title:"名称",dataIndex:"title",render:e=>(0,P.jsx)("div",{dangerouslySetInnerHTML:{__html:I(e,y||"")}}),width:300},{title:"路径",dataIndex:"path"},{title:"图标",dataIndex:"icon",hideInSearch:!0},{title:"类型",dataIndex:"type",render:e=>{const n=m.menuType.map[e];return(0,P.jsx)(s.Z,{color:n.color,children:n.label})},type:"select",options:m.menuType.options},{title:"按钮",dataIndex:"buttonList",render:e=>e?.map((e=>(0,P.jsx)(s.Z,{color:"#2db7f5",children:e.name},e.id)))},{title:"操作",key:"action",render:e=>(0,P.jsx)(i.Z,{children:k(e)}),width:100,fixed:"right",hideInSearch:!0,hideInTable:!O}];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(d.Z,{rowKey:"id",dataSource:Z,search:!1,columns:S,headerTitle:"菜单列表",toolBarRender:(0,P.jsxs)(i.Z,{children:[(0,P.jsx)(c.Z,{value:y,prefix:(0,P.jsx)(u.Z,{}),placeholder:"输入菜单名称查询",style:{width:200},onPressEnter:e=>{const{value:n}=e.target;C(n)}}),(0,P.jsx)(b.ZP,{permission:"add",children:(0,P.jsx)(l.ZP,{type:"primary",icon:(0,P.jsx)(p.Z,{}),onClick:()=>j.current?.addStart(),children:"新增"})})]}),pagination:!1,loading:f}),v]})}},22701:function(e,n,r){r.d(n,{Bb:function(){return t},Zm:function(){return l}});const t=function(e){const n=e.split("/"),r=n[n.length-1],t=r.lastIndexOf(".");return t<=0?r:r.substring(0,t)+r.substring(t)},o=function(e){if("object"!=typeof e||null===e)return e;const n=Array.isArray(e)?[]:{};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=o(e[r]));return n},l=function(e=[],n){const r=o(e),t=e=>e.map((e=>{const r=t(e.children||[]);return n(e)?(e.children=r.length>0?r:void 0,e):r&&r.length>0?(e.children=r,e):null})).filter((e=>null!==e));return t(r)}},53139:function(e,n,r){var t=r(78944);n.Z=t.Z},10011:function(e,n,r){var t=r(1308);n.Z=t.Z},16509:function(e,n,r){r.d(n,{Z:function(){return I}});var t=r(89526),o=r(17431),l=r(70854),a=r.n(l),s=r(50159),i=r(73591),c=r(89651),d=r(25342),u=r(13806),p=r(13728),m=r(11351),f=r(94237),h=r(55439);const g=e=>{const{lineWidth:n,fontSizeIcon:r,calc:t}=e,o=e.fontSizeSM;return(0,f.TS)(e,{tagFontSize:o,tagLineHeight:(0,u.bf)(t(e.lineHeightSM).mul(o).equal()),tagIconSize:t(r).sub(t(n).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},b=e=>({defaultBg:new p.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var x=(0,h.I$)("Tag",(e=>(e=>{const{paddingXXS:n,lineWidth:r,tagPaddingHorizontal:t,componentCls:o,calc:l}=e,a=l(t).sub(r).equal(),s=l(n).sub(r).equal();return{[o]:Object.assign(Object.assign({},(0,m.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:a,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,u.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${o}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${o}-close-icon`]:{marginInlineStart:s,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${o}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${o}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:a}}),[`${o}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}})(g(e))),b);const y=t.forwardRef(((e,n)=>{const{prefixCls:r,style:o,className:l,checked:s,onChange:i,onClick:c}=e,u=function(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(r[t[o]]=e[t[o]])}return r}(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:p,tag:m}=t.useContext(d.E_),f=p("tag",r),[h,g,b]=x(f),y=a()(f,`${f}-checkable`,{[`${f}-checkable-checked`]:s},null==m?void 0:m.className,l,g,b);return h(t.createElement("span",Object.assign({},u,{ref:n,style:Object.assign(Object.assign({},o),null==m?void 0:m.style),className:y,onClick:e=>{null==i||i(!s),null==c||c(e)}})))}));var C=y,Z=r(7606),j=(0,h.bk)(["Tag","preset"],(e=>(e=>(0,Z.Z)(e,((n,r)=>{let{textColor:t,lightBorderColor:o,lightColor:l,darkColor:a}=r;return{[`${e.componentCls}${e.componentCls}-${n}`]:{color:t,background:l,borderColor:o,"&-inverse":{color:e.colorTextLightSolid,background:a,borderColor:a},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}})))(g(e))),b);const v=(e,n,r)=>{const t="string"!=typeof(o=r)?o:o.charAt(0).toUpperCase()+o.slice(1);var o;return{[`${e.componentCls}${e.componentCls}-${n}`]:{color:e[`color${r}`],background:e[`color${t}Bg`],borderColor:e[`color${t}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var k=(0,h.bk)(["Tag","status"],(e=>{const n=g(e);return[v(n,"success","Success"),v(n,"processing","Info"),v(n,"error","Error"),v(n,"warning","Warning")]}),b);const O=(e,n)=>{const{prefixCls:r,className:l,rootClassName:u,style:p,children:m,icon:f,color:h,onClose:g,closeIcon:b,closable:y,bordered:C=!0}=e,Z=function(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(r[t[o]]=e[t[o]])}return r}(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","closeIcon","closable","bordered"]),{getPrefixCls:v,direction:O,tag:$}=t.useContext(d.E_),[I,P]=t.useState(!0);t.useEffect((()=>{"visible"in Z&&P(Z.visible)}),[Z.visible]);const S=(0,s.o2)(h),w=(0,s.yT)(h),T=S||w,E=Object.assign(Object.assign({backgroundColor:h&&!T?h:void 0},null==$?void 0:$.style),p),N=v("tag",r),[F,B,z]=x(N),A=a()(N,null==$?void 0:$.className,{[`${N}-${h}`]:T,[`${N}-has-color`]:h&&!T,[`${N}-hidden`]:!I,[`${N}-rtl`]:"rtl"===O,[`${N}-borderless`]:!C},l,u,B,z),H=e=>{e.stopPropagation(),null==g||g(e),e.defaultPrevented||P(!1)},[,R]=(0,i.Z)({closable:y,closeIcon:null!=b?b:null==$?void 0:$.closeIcon,customCloseIconRender:e=>null===e?t.createElement(o.Z,{className:`${N}-close-icon`,onClick:H}):t.createElement("span",{className:`${N}-close-icon`,onClick:H},e),defaultCloseIcon:null,defaultClosable:!1}),q="function"==typeof Z.onClick||m&&"a"===m.type,L=f||null,M=L?t.createElement(t.Fragment,null,L,m&&t.createElement("span",null,m)):m,_=t.createElement("span",Object.assign({},Z,{ref:n,className:A,style:E}),M,R,S&&t.createElement(j,{key:"preset",prefixCls:N}),w&&t.createElement(k,{key:"status",prefixCls:N}));return F(q?t.createElement(c.Z,{component:"Tag"},_):_)},$=t.forwardRef(O);$.CheckableTag=C;var I=$}}]);
//# sourceMappingURL=626.e1a594ac.chunk.js.map