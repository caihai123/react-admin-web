"use strict";(self.webpackChunkreact_admin_web=self.webpackChunkreact_admin_web||[]).push([[738],{60824:function(e,r,n){n.d(r,{S:function(){return t},n:function(){return l}});var o=n(95694);const t=()=>o.Z.get("/api/menu/all"),l=e=>o.Z.post("/api/menu/remove",{id:e})},10427:function(e,r,n){var o=n(54374),t=n(53725),l=n(68347),a=n(67557);const s=l;r.Z=function(e){const{dictName:r,placeholder:n="请选择",...l}=e,{options:i}=s[r];return(0,a.jsx)(o.default,{...l,placeholder:n,children:i.map((e=>(0,a.jsx)(o.default.Option,{value:e.value,children:e.color?(0,a.jsx)(t.Z,{color:e.color,text:e.label}):e.label},e.value)))})}},81375:function(e,r,n){var o=n(89526),t=n(20485),l=n(9740),a=n(74918),s=n(96799),i=n(5416),c=n(95267),d=n(49839),u=n(67557);const p=(0,o.forwardRef)((function(e,r){const{title:n,width:d,submitText:p="确定",cancelText:m="取消",children:h,modalProps:g,formProps:f,onFinish:b,footer:x,initialValues:C,afterClose:y}=e,[Z,{set:j}]=(0,t.Z)(!1),[v,k]=(0,c.ZP)(!1);return(0,o.useImperativeHandle)(r,(()=>({open:()=>j(!0),close:()=>j(!1)}))),(0,u.jsx)(l.Z,{title:n,open:Z,onCancel:()=>j(!1),width:d,footer:x||(0,u.jsxs)(a.Z,{children:[(0,u.jsx)(s.ZP,{onClick:()=>j(!1),children:m}),(0,u.jsx)(s.ZP,{type:"primary",loading:v,onClick:()=>e.form?.submit(),children:p})]}),centered:!0,wrapClassName:"custom-modal-style",maskClosable:!1,afterClose:y,...g,children:(0,u.jsx)(i.Z,{form:e.form,autoComplete:"off",onFinish:e=>{const r=b?.(e);r instanceof Promise&&(k.setTrue(),r.then((()=>j(!1))).finally((()=>k.setFalse())))},layout:"vertical",initialValues:C,...f,children:h})})}));r.Z=(0,d.Z)(p,{useModal:function(e){const r=(0,o.useRef)(null),[n]=i.Z.useForm();return[r,n,(0,u.jsx)(p,{ref:r,form:n,...e})]}})},80035:function(e,r,n){n.r(r),n.d(r,{default:function(){return E}});var o=n(89526),t=n(72816),l=n(96799),a=n(24059),s=n(16509),i=n(74918),c=n(57503),d=n(25877),u=n(60561),p=n(58047),m=n(68347),h=n(60824),g=n(63953),f=n(5416),b=n(10011),x=n(53139),C=n(91117),y=n(95694),Z=n(81375),j=n(10427),v=n(49839),k=n(17431);const S={pattern:/^\/[\w-/]*$/,message:"必须以斜杠开头，后跟字母、数字、下划线、中划线或斜杠"},$={pattern:/^[a-z][a-z0-9-]*$/,message:"只能是小写字母、中划线和数字组成，且必须以字母开头"};var w=n(67557);const I=o.forwardRef(((e,r)=>{const{message:n}=t.Z.useApp(),[a,s]=o.useState(""),d=o.useRef(null),[u]=f.Z.useForm(),p=f.Z.useWatch("type",u);return o.useImperativeHandle(r,(()=>({addStart:e=>{u.setFieldValue("parentId",e),d.current?.open()},editStart:e=>{s(e.id),u.setFieldsValue(e),d.current?.open()}}))),(0,w.jsxs)(Z.Z,{ref:d,form:u,title:a?"编辑":"新增",width:800,afterClose:()=>{s(""),u.resetFields()},initialValues:{type:m.menuType.enum.menu},onFinish:r=>{const o=a?"/api/menu/update":"/api/menu/add",t=a?"更新成功！":"新增成功！",l=a?{id:a,...r}:r;return y.Z.post(o,l).then((()=>{n.success(t),e.callback(!a)}))},children:[(0,w.jsxs)(b.Z,{gutter:16,children:[(0,w.jsx)(x.Z,{span:12,children:(0,w.jsx)(f.Z.Item,{label:"父节点",name:"parentId",required:!0,children:(0,w.jsx)(C.Z,{treeData:e.menuTreeAll,fieldNames:{label:"title",value:"id"},placeholder:"根节点",disabled:!0})})}),(0,w.jsx)(x.Z,{span:12,children:(0,w.jsx)(f.Z.Item,{label:"名称",name:"title",rules:[{required:!0},{type:"string",min:2,max:10,message:"长度在 2 到 10 个字符！"}],children:(0,w.jsx)(c.Z,{placeholder:"菜单名称"})})}),(0,w.jsx)(x.Z,{span:12,children:(0,w.jsx)(f.Z.Item,{label:"类型",name:"type",rules:[{required:!0}],children:(0,w.jsx)(j.Z,{placeholder:"菜单类型",dictName:"menuType"})})}),p===m.menuType.enum.menu&&(0,w.jsx)(x.Z,{span:12,children:(0,w.jsx)(f.Z.Item,{label:"路径",name:"path",rules:[{required:!0},S],children:(0,w.jsx)(c.Z,{placeholder:"菜单路径"})})}),(0,w.jsx)(x.Z,{span:12,children:(0,w.jsx)(f.Z.Item,{label:"图标",name:"icon",children:(0,w.jsx)(c.Z,{placeholder:"图标名称"})})})]}),p===m.menuType.enum.menu&&(0,w.jsx)(b.Z,{gutter:16,children:(0,w.jsx)(x.Z,{span:12,children:(0,w.jsx)(f.Z.Item,{label:"按钮",children:(0,w.jsx)(f.Z.List,{name:"buttonList",children:(e,r)=>(0,w.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[e.map((({key:e,name:n})=>(0,w.jsxs)(i.Z,{align:"baseline",children:[(0,w.jsx)(f.Z.Item,{name:[n,"name"],rules:[{required:!0,message:"按钮名称是必选字段"}],children:(0,w.jsx)(c.Z,{placeholder:"按钮名称"})}),(0,w.jsx)(f.Z.Item,{name:[n,"id"],rules:[{required:!0,message:"按钮标识是必选字段"},$],children:(0,w.jsx)(c.Z,{placeholder:"按钮标识"})}),(0,w.jsx)(k.Z,{onClick:()=>r.remove(n)})]},e))),(0,w.jsx)(l.ZP,{type:"dashed",onClick:()=>r.add(),block:!0,children:"+ 新增按钮"})]})})})})})]})}));var T=(0,v.Z)(I,{useModal:function(e){const r=o.useRef(null);return[r,(0,w.jsx)(I,{ref:r,...e})]}}),P=n(88238),O=n(26482);function E(){const{modal:e,message:r}=t.Z.useApp(),{data:n,loading:f,refresh:b}=(0,P.Z)((async()=>(await(0,h.S)()).result)),[x,C]=o.useState(),[y,Z]=o.useState(),j=o.useMemo((()=>y?(0,O.Zm)(n,(e=>e.title.toLowerCase().includes(y.toLowerCase()))):n),[n,y]),[v,k]=T.useModal({menuTreeAll:n,callback:e=>{b(),e&&(Z(void 0),C(void 0))}}),[S,$]=(0,g.Fu)({render:e=>(0,w.jsx)(l.ZP,{type:"primary",ghost:!0,size:"small",onClick:()=>v.current?.editStart(e),children:"编辑"}),permission:"edit"},{render:e=>(0,w.jsx)(l.ZP,{type:"primary",size:"small",onClick:()=>v.current?.addStart(e.id),children:"新增下级"}),permission:"add"},{render:n=>(0,w.jsx)(l.ZP,{type:"primary",danger:!0,size:"small",onClick:()=>e.confirm({title:"提示",content:"确定要删除此菜单及其子菜单吗？",okType:"danger",onOk:()=>(0,h.n)(n.id).then((()=>{r.success("删除成功！"),b()})),centered:!0}),children:"删除"}),permission:"del"}),{token:{colorError:I}}=a.Z.useToken(),E=o.useCallback((function(e,r){if(!r)return e;const n=new RegExp(`(${r})`,"gi");return e.replace(n,`<span style="color:${I}">$1</span>`)}),[I]),N=[{title:"名称",dataIndex:"title",render:e=>(0,w.jsx)("div",{dangerouslySetInnerHTML:{__html:E(e,y||"")}}),width:300},{title:"路径",dataIndex:"path"},{title:"图标",dataIndex:"icon",hideInSearch:!0},{title:"类型",dataIndex:"type",render:e=>{const r=m.menuType.map[e];return(0,w.jsx)(s.Z,{color:r.color,children:r.label})},type:"select",options:m.menuType.options},{title:"按钮",dataIndex:"buttonList",render:e=>e?.map((e=>(0,w.jsx)(s.Z,{color:"#2db7f5",children:e.name},e.id)))},{title:"操作",key:"action",render:e=>(0,w.jsx)(i.Z,{children:S(e)}),width:100,fixed:"right",hideInSearch:!0,hideInTable:!$}];return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(d.Z,{rowKey:"id",dataSource:j,search:!1,columns:N,headerTitle:"菜单列表",toolBarRender:(0,w.jsxs)(i.Z,{children:[(0,w.jsx)(c.Z,{value:x,prefix:(0,w.jsx)(u.Z,{}),placeholder:"输入菜单名称查询",style:{width:200},onChange:e=>C(e.target.value),onPressEnter:()=>Z(x)}),(0,w.jsx)(g.ZP,{permission:"add",children:(0,w.jsx)(l.ZP,{type:"primary",icon:(0,w.jsx)(p.Z,{}),onClick:()=>v.current?.addStart(),children:"新增"})})]}),pagination:!1,loading:f,onRefresh:()=>b()}),k]})}},53139:function(e,r,n){var o=n(78944);r.Z=o.Z},10011:function(e,r,n){var o=n(1308);r.Z=o.Z},16509:function(e,r,n){n.d(r,{Z:function(){return I}});var o=n(89526),t=n(70854),l=n.n(t),a=n(61370),s=n(50159),i=n(73591),c=n(42514),d=n(89651),u=n(25342),p=n(13806),m=n(13728),h=n(11351),g=n(94237),f=n(55439);const b=e=>{const{lineWidth:r,fontSizeIcon:n,calc:o}=e,t=e.fontSizeSM;return(0,g.TS)(e,{tagFontSize:t,tagLineHeight:(0,p.bf)(o(e.lineHeightSM).mul(t).equal()),tagIconSize:o(n).sub(o(r).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},x=e=>({defaultBg:new m.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var C=(0,f.I$)("Tag",(e=>(e=>{const{paddingXXS:r,lineWidth:n,tagPaddingHorizontal:o,componentCls:t,calc:l}=e,a=l(o).sub(n).equal(),s=l(r).sub(n).equal();return{[t]:Object.assign(Object.assign({},(0,h.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:a,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,p.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${t}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${t}-close-icon`]:{marginInlineStart:s,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${t}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${t}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:a}}),[`${t}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}})(b(e))),x);const y=o.forwardRef(((e,r)=>{const{prefixCls:n,style:t,className:a,checked:s,onChange:i,onClick:c}=e,d=function(e,r){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(o=Object.getOwnPropertySymbols(e);t<o.length;t++)r.indexOf(o[t])<0&&Object.prototype.propertyIsEnumerable.call(e,o[t])&&(n[o[t]]=e[o[t]])}return n}(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:p,tag:m}=o.useContext(u.E_),h=p("tag",n),[g,f,b]=C(h),x=l()(h,`${h}-checkable`,{[`${h}-checkable-checked`]:s},null==m?void 0:m.className,a,f,b);return g(o.createElement("span",Object.assign({},d,{ref:r,style:Object.assign(Object.assign({},t),null==m?void 0:m.style),className:x,onClick:e=>{null==i||i(!s),null==c||c(e)}})))}));var Z=y,j=n(7606),v=(0,f.bk)(["Tag","preset"],(e=>(e=>(0,j.Z)(e,((r,n)=>{let{textColor:o,lightBorderColor:t,lightColor:l,darkColor:a}=n;return{[`${e.componentCls}${e.componentCls}-${r}`]:{color:o,background:l,borderColor:t,"&-inverse":{color:e.colorTextLightSolid,background:a,borderColor:a},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}})))(b(e))),x);const k=(e,r,n)=>{const o="string"!=typeof(t=n)?t:t.charAt(0).toUpperCase()+t.slice(1);var t;return{[`${e.componentCls}${e.componentCls}-${r}`]:{color:e[`color${n}`],background:e[`color${o}Bg`],borderColor:e[`color${o}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var S=(0,f.bk)(["Tag","status"],(e=>{const r=b(e);return[k(r,"success","Success"),k(r,"processing","Info"),k(r,"error","Error"),k(r,"warning","Warning")]}),x);const $=o.forwardRef(((e,r)=>{const{prefixCls:n,className:t,rootClassName:p,style:m,children:h,icon:g,color:f,onClose:b,bordered:x=!0,visible:y}=e,Z=function(e,r){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(o=Object.getOwnPropertySymbols(e);t<o.length;t++)r.indexOf(o[t])<0&&Object.prototype.propertyIsEnumerable.call(e,o[t])&&(n[o[t]]=e[o[t]])}return n}(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:j,direction:k,tag:$}=o.useContext(u.E_),[w,I]=o.useState(!0),T=(0,a.Z)(Z,["closeIcon","closable"]);o.useEffect((()=>{void 0!==y&&I(y)}),[y]);const P=(0,s.o2)(f),O=(0,s.yT)(f),E=P||O,N=Object.assign(Object.assign({backgroundColor:f&&!E?f:void 0},null==$?void 0:$.style),m),F=j("tag",n),[z,B,R]=C(F),H=l()(F,null==$?void 0:$.className,{[`${F}-${f}`]:E,[`${F}-has-color`]:f&&!E,[`${F}-hidden`]:!w,[`${F}-rtl`]:"rtl"===k,[`${F}-borderless`]:!x},t,p,B,R),L=e=>{e.stopPropagation(),null==b||b(e),e.defaultPrevented||I(!1)},[,q]=(0,i.Z)((0,i.w)(e),(0,i.w)($),{closable:!1,closeIconRender:e=>{const r=o.createElement("span",{className:`${F}-close-icon`,onClick:L},e);return(0,c.wm)(e,r,(e=>({onClick:r=>{var n;null===(n=null==e?void 0:e.onClick)||void 0===n||n.call(e,r),L(r)},className:l()(null==e?void 0:e.className,`${F}-close-icon`)})))}}),M="function"==typeof Z.onClick||h&&"a"===h.type,_=g||null,A=_?o.createElement(o.Fragment,null,_,h&&o.createElement("span",null,h)):h,W=o.createElement("span",Object.assign({},T,{ref:r,className:H,style:N}),A,q,P&&o.createElement(v,{key:"preset",prefixCls:F}),O&&o.createElement(S,{key:"status",prefixCls:F}));return z(M?o.createElement(d.Z,{component:"Tag"},W):W)})),w=$;w.CheckableTag=Z;var I=w}}]);
//# sourceMappingURL=738.e202de1c.chunk.js.map