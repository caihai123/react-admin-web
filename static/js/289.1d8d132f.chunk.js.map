{"version":3,"file":"static/js/289.1d8d132f.chunk.js","mappings":"4OASO,MAAMA,EAAyB,WACpC,MAAM,SAAEC,IAAaC,EAAAA,EAAAA,MAGfC,GAFcC,EAAAA,EAAAA,IAAYC,EAAAA,IAECC,MAAMC,GAASA,EAAKC,OAASP,IAE9D,OAAQQ,GAAUN,EAAaO,YAAYC,MAAMJ,GAASA,EAAKK,KAAOH,GACxE,EAmBaI,EAA6B,YAAaC,GACrD,MAAMC,EAAsBf,IAEtBgB,EAAmBF,EAAmBG,QAAQV,GAClDQ,EAAoBR,EAAKW,cAgB3B,MAAO,CAXQ,YAAaC,GAC1B,OACEC,EAAAA,EAAAA,KAACC,EAAAA,SAAQ,CAAAC,SACNN,EAAiBO,KAAKhB,IACrB,MAAMiB,EAAUjB,EAAKkB,UAAUN,GAC/B,OAAOC,EAAAA,EAAAA,KAACC,EAAAA,SAAQ,CAAAC,SAAwBE,GAAlBjB,EAAKW,WAAgC,KAInE,IAX+BF,EAAiBU,OAclD,EAOe,SAASC,GAAkB,WAAET,EAAU,SAAEI,IAGtD,OAF4BtB,GAErBe,CAAoBG,GAAcI,OAAWM,CACtD,C,iMC7De,SAASC,GAAiB,eACvCC,GAAiB,EAAK,SACtBC,EAAWA,KAAM,QAEjB,MAAOC,GAAS,IAAEC,KAASC,EAAAA,EAAAA,GAAWJ,IAC/BK,GAAS,QAAEC,EAAO,SAAEC,KAAcC,EAAAA,EAAAA,KAAuB,GAEhE,OACElB,EAAAA,EAAAA,KAACmB,EAAAA,EAAM,CACLP,QAASA,EACTG,QAASA,EACTJ,SAAWS,IACTP,EAAIO,GACJJ,IACAL,EAASS,IACLC,OAAM,KACNR,GAAKO,EAAI,IAEVE,SAAQ,IAAML,KAAW,GAIpC,C,gJC0CA,GAAe,QAlDGM,IAChB,MACIC,UAAWC,EAAkB,UAC7BC,EAAS,UACTC,EAAS,SACTC,EAAQ,KACRC,EAAI,MACJC,EAAK,SACL5B,EAAQ,OACR6B,GACER,EACJS,EA7BgC,SAAUC,EAAGC,GAC/C,IAAIC,EAAI,CAAC,EACT,IAAK,IAAIC,KAAKH,EAAOI,OAAOC,UAAUC,eAAeC,KAAKP,EAAGG,IAAMF,EAAEO,QAAQL,GAAK,IAAGD,EAAEC,GAAKH,EAAEG,IAC9F,GAAS,MAALH,GAAqD,mBAAjCI,OAAOK,sBAA2C,KAAIC,EAAI,EAAb,IAAgBP,EAAIC,OAAOK,sBAAsBT,GAAIU,EAAIP,EAAE9B,OAAQqC,IAClIT,EAAEO,QAAQL,EAAEO,IAAM,GAAKN,OAAOC,UAAUM,qBAAqBJ,KAAKP,EAAGG,EAAEO,MAAKR,EAAEC,EAAEO,IAAMV,EAAEG,EAAEO,IADuB,CAGvH,OAAOR,CACT,CAsBgBU,CAAOtB,EAAO,CAAC,YAAa,YAAa,YAAa,WAAY,OAAQ,QAAS,WAAY,YACvG,aACJuB,GACE,aAAiB,MACfC,EAAgBD,IAChBtB,EAAYC,GAAsBqB,EAAa,SAC/CE,GAAU,EAAAC,EAAA,GAAaF,IACtBG,EAAYC,EAAQC,IAAa,QAAS5B,EAAWwB,GACtDK,EAAmB,GAAG7B,YAE5B,IAAI8B,EAAkB,CAAC,EAqBvB,OAnBEA,EADEzB,EACgB,CAChBD,SAAUA,SAA2CA,EACrDE,MAAO,GACPC,OAAQ,GACR7B,SAAyB,gBAAoB,IAAgBmC,OAAOkB,OAAO,CAAC,EAAGhC,EAAO,CACpFC,UAAWA,EACX6B,iBAAkBA,EAClBN,cAAeA,EACfS,QAAStD,MAIK,CAChB0B,SAAUA,SAA2CA,EACrDE,QACAC,OAAmB,OAAXA,GAAgC,gBAAoB,IAAQM,OAAOkB,OAAO,CAAC,EAAGhC,IACtFrB,YAGGgD,EAAyB,gBAAoB,IAAOb,OAAOkB,OAAO,CACvE/B,UAAWA,EACXE,UAAW,IAAWyB,EAAQ,GAAG3B,eAAwBK,GAAQwB,EAAkBxB,GAAQ,GAAGwB,KAAoBxB,IAAQH,EAAW0B,EAAWJ,IAC/IhB,EAAW,CACZL,WAAW,OAAgBH,EAAWG,GACtCC,SAAUA,GACT0B,IAAkB,I,UC7DvB,SAASG,EAAUlC,GACjB,OAAO,SAAQ,QAASA,GAC1B,CACA,MAAM,EAAQ,IACd,EAAMmC,SAAWA,EAAA,EACjB,EAAMC,KAAO,SAAgBpC,GAC3B,OAAO,SAAQ,QAASA,GAC1B,EACA,EAAMqC,QAAU,SAAmBrC,GACjC,OAAO,SAAQ,QAAYA,GAC7B,EACA,EAAMsC,MAAQ,SAAiBtC,GAC7B,OAAO,SAAQ,QAAUA,GAC3B,EACA,EAAMuC,QAAUL,EAChB,EAAMM,KAAON,EACb,EAAMO,QAAU,SAAmBzC,GACjC,OAAO,SAAQ,QAAYA,GAC7B,EACA,EAAM0C,WAAa,WACjB,KAAOC,EAAA,UAAmB,CACxB,MAAMC,EAAQD,EAAA,QACVC,GACFA,GAEJ,CACF,EACA,EAAMC,OAAS,KACf,EAAMC,uCAAyC,EAI/C,Q,WC4CA,GA9EkBC,EAAAA,EAAAA,aAAW,CAAC/C,EAAOgD,KACnC,MAAM,QAAEC,GAAYC,EAAAA,EAAAA,UAEbC,GAAYC,EAAAA,EAAAA,WAEZnF,EAAIoF,IAASC,EAAAA,EAAAA,UAAS,KACtBC,EAASC,IAAcF,EAAAA,EAAAA,WAAS,IAChC9D,GAAS,QAAEC,EAAO,SAAEC,KAAcC,EAAAA,EAAAA,KAAuB,GA2BhE,OATA8D,EAAAA,EAAAA,qBAAoBT,GAAK,KAAM,CAC7BU,SAAUA,IAAMF,GAAW,GAC3BG,UAAYC,IACVP,EAAMO,EAAI3F,IACVkF,EAASU,eAAeD,GACxBJ,GAAW,EAAK,OAKlB/E,EAAAA,EAAAA,KAACqF,EAAK,CACJvD,MAAOtC,EAAK,KAAO,KACnB8F,KAAMR,EACNS,MAAO,IACPxD,QACEyD,EAAAA,EAAAA,MAACC,EAAAA,EAAK,CAAAvF,SAAA,EACJF,EAAAA,EAAAA,KAAC0F,EAAAA,GAAM,CAACC,QAASA,IAAMZ,GAAW,GAAO7E,SAAC,QAC1CF,EAAAA,EAAAA,KAAC0F,EAAAA,GAAM,CACL7D,KAAK,UACLd,QAASA,EACT4E,QAASA,IAAMjB,EAASkB,SAAS1F,SAClC,UAKL2F,SAAUA,IAAMd,GAAW,GAC3Be,WAAYA,KACVlB,EAAM,IACNF,EAASqB,aAAa,EACtB7F,UAEFsF,EAAAA,EAAAA,MAACb,EAAAA,EAAI,CACHqB,KAAMtB,EACNuB,OAAO,WACPC,SAnDW,SAAUC,GACzBnF,GAAQ,GACR,MAAMoF,EAAS5G,EAAK,mBAAqB,gBACnC6G,EAAa7G,EAAK,QAAU,QAC5B8G,EAAS9G,EAAK,CAAEA,QAAO2G,GAASA,EAEtCI,EAAAA,EAAAA,KACQH,EAAQE,GACbE,MAAK,KACJzB,GAAW,GACXP,EAAQZ,QAAQyC,GALG9E,EAAMkF,WAAWjH,OAAKgB,EAAY,EAM3C,IAEXc,SAAQ,IAAML,KACnB,EAsCMyF,aAAa,MAAKxG,SAAA,EAElBF,EAAAA,EAAAA,KAAC2E,EAAAA,EAAAA,KAAS,CACRgC,KAAK,WACLC,MAAM,OACNC,MAAO,CAAC,CAAEC,UAAU,EAAMtC,QAAS,YAAatE,UAEhDF,EAAAA,EAAAA,KAAC+G,EAAAA,EAAK,CAACC,YAAY,WAErBhH,EAAAA,EAAAA,KAAC2E,EAAAA,EAAAA,KAAS,CAACgC,KAAK,cAAcC,MAAM,KAAI1G,UACtCF,EAAAA,EAAAA,KAAC+G,EAAAA,EAAAA,SAAc,CAACC,YAAY,cAG1B,I,sBCnEG,SAASC,IACtB,MAAM,QAAEzC,GAAYC,EAAAA,EAAAA,SAUdyC,GAAWC,EAAAA,EAAAA,UACXC,GAAeD,EAAAA,EAAAA,WAGdE,EAAcC,IAAgB7H,EAAAA,EAAAA,IACnC,CACEY,OAAS8E,IACPnF,EAAAA,EAAAA,KAAC0F,EAAAA,GAAM,CAAC7D,KAAK,UAAU0F,OAAK,EAACC,KAAK,QAAOtH,SAAC,OAI5CJ,WAAY,QAEd,CACEO,OAAS8E,IACPnF,EAAAA,EAAAA,KAAC0F,EAAAA,GAAM,CAAC7D,KAAK,UAAU2F,KAAK,QAAOtH,SAAC,OAItCJ,WAAY,YAEd,CACEO,OAAS8E,IACPnF,EAAAA,EAAAA,KAAC0F,EAAAA,GAAM,CAAC7D,KAAK,UAAU4F,QAAM,EAACD,KAAK,QAAOtH,SAAC,OAI7CJ,WAAY,QAIV4H,EAAU,CACd,CACE5F,MAAO,OACP6F,UAAW,YAEb,CACE7F,MAAO,KACP6F,UAAW,cACXC,cAAc,GAEhB,CACE9F,MAAO,KACP6F,UAAW,SACXtH,OAAQA,CAACwH,EAAQ1C,KACf,MAAM,QAAE2C,EAAO,SAAEC,GAAaC,EAAAA,iBAAAA,KAC9B,OACEhI,EAAAA,EAAAA,KAACS,EAAgB,CACfC,eAAgBmH,IAAWC,EAC3BnH,SAAWS,GAxDA,SAAU5B,EAAIqI,GACjC,OAAOtB,EAAAA,EAAAA,KAAW,0BAA2B,CAAE/G,KAAIqI,WAAUrB,MAAK,KAEhEhC,EAAQZ,QAAQ,QAAQ,GAE5B,CAmD6BqE,CAAa9C,EAAI3F,GAAI4B,EAAM0G,EAAUC,IACxD,EAGNlG,KAAM,SACNqG,QAASF,EAAAA,iBAAAA,SAEX,CACElG,MAAO,KACPqG,IAAK,SACL9H,OAAS8E,IAAQnF,EAAAA,EAAAA,KAACyF,EAAAA,EAAK,CAAAvF,SAAEmH,EAAalC,KACtCI,MAAO,IACP6C,MAAO,QACPR,cAAc,EACdS,aAAcf,IAIlB,OACE9B,EAAAA,EAAAA,MAAA8C,EAAAA,SAAA,CAAApI,SAAA,EACEF,EAAAA,EAAAA,KAACuI,EAAAA,EAAQ,CACPhE,IAAK2C,EACLQ,QAASA,EACTc,OAAO,KACPC,YAAY,OACZC,QAASA,CAACpC,GAAUqC,UAASC,cAC3BrC,EAAAA,EAAAA,KACQ,iBAAkB,CAAED,SAAQuC,UAAWF,EAASC,aACrDpC,MAAMsC,IACL,MAAQC,OAAQ5C,GAAS2C,EACzB,MAAO,CACLE,KAAM7C,EAAK8C,QACXC,MAAO/C,EAAK+C,MACb,IAGPC,cAAeA,KACbnJ,EAAAA,EAAAA,KAACO,EAAAA,GAAiB,CAACT,WAAW,MAAKI,UACjCF,EAAAA,EAAAA,KAAC0F,EAAAA,GAAM,CACL7D,KAAK,UACLuH,MAAMpJ,EAAAA,EAAAA,KAACqJ,EAAAA,EAAY,IACnB1D,QAASA,IAAMyB,EAAauB,QAAQ1D,WAAW/E,SAChD,YAOPF,EAAAA,EAAAA,KAACsJ,EAAS,CACR/E,IAAK6C,EACLX,SAAWoC,GAAc3B,EAASyB,QAAQY,QAAQV,OAI1D,C","sources":["webpack://react-admin-web/./src/components/PermissionControl.jsx","webpack://react-admin-web/./src/components/OptimisticSwitch.jsx","webpack://react-admin-web/./node_modules/antd/es/modal/PurePanel.js","webpack://react-admin-web/./node_modules/antd/es/modal/index.js","webpack://react-admin-web/./src/pages/permis/role/AddOrEdit.jsx","webpack://react-admin-web/./src/pages/permis/role/index.jsx"],"sourcesContent":["import { Fragment } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectMenuFlatten } from \"@/store/menu\";\r\n\r\n/**\r\n * 返回针对当前页的权限判断函数\r\n * @returns function\r\n */\r\nexport const useButtonAuthorization = function () {\r\n  const { pathname } = useLocation();\r\n  const menuFlatten = useSelector(selectMenuFlatten);\r\n\r\n  const currentRoute = menuFlatten.find((item) => item.path === pathname);\r\n\r\n  return (butId) => currentRoute.buttonList?.some((item) => item.id === butId);\r\n};\r\n\r\n/**\r\n * 判断是否至少拥有一个权限\r\n * @param  {...string} permissions 按钮标识\r\n * @returns Boolean\r\n */\r\nexport const useAnyButtonPermission = function (...permissions) {\r\n  const hasButtonPermission = useButtonAuthorization();\r\n  return permissions.some((permission) => hasButtonPermission(permission));\r\n};\r\n\r\n/**\r\n * 传入一个或多个按钮，返回有权限的按钮\r\n * @param  {...object} permissionElements\r\n * @param {string} permissionElements[].permission - 按钮的权限标识\r\n * @param {function} permissionElements[].render - 用于渲染元素的函数\r\n * @returns [render, hasPermissionButtons]\r\n */\r\nexport const useFilterElementPermission = function (...permissionElements) {\r\n  const hasButtonPermission = useButtonAuthorization();\r\n\r\n  const filteredElements = permissionElements.filter((item) =>\r\n    hasButtonPermission(item.permission)\r\n  );\r\n\r\n  const hasPermissionButtons = !!filteredElements.length;\r\n\r\n  const render = function (...argument) {\r\n    return (\r\n      <Fragment>\r\n        {filteredElements.map((item) => {\r\n          const element = item.render(...argument);\r\n          return <Fragment key={item.permission}>{element}</Fragment>;\r\n        })}\r\n      </Fragment>\r\n    );\r\n  };\r\n\r\n  return [render, hasPermissionButtons];\r\n};\r\n\r\n/**\r\n * 按钮权限鉴权组件\r\n * @param {string} permission - 按钮的权限标识\r\n * @param {ReactNode} children - 按钮元素\r\n */\r\nexport default function PermissionControl({ permission, children }) {\r\n  const hasButtonPermission = useButtonAuthorization();\r\n\r\n  return hasButtonPermission(permission) ? children : undefined;\r\n}\r\n","import { useBoolean } from \"ahooks\";\r\nimport { Switch } from \"antd\";\r\nimport useLoadingDelayAndKeep from \"@/hooks/useLoadingDelayAndKeep\";\r\n\r\n// 切换失败时自动撤销的 Optimistic Updates 开关\r\n// 注意：暂时还没完全想清楚此组件要不要作为公共基础组件存在\r\nexport default function OptimisticSwitch({\r\n  defaultChecked = false,\r\n  onChange = () => null,\r\n}) {\r\n  const [checked, { set }] = useBoolean(defaultChecked);\r\n  const [loading, { setTrue, setFalse }] = useLoadingDelayAndKeep(false);\r\n\r\n  return (\r\n    <Switch\r\n      checked={checked}\r\n      loading={loading}\r\n      onChange={(val) => {\r\n        set(val);\r\n        setTrue();\r\n        onChange(val)\r\n          ?.catch(() => {\r\n            set(!val);\r\n          })\r\n          .finally(() => setFalse());\r\n      }}\r\n    ></Switch>\r\n  );\r\n}\r\n","\"use client\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n/* eslint-disable react/jsx-no-useless-fragment */\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport { Panel } from 'rc-dialog';\nimport { withPureRenderTheme } from '../_util/PurePanel';\nimport { ConfigContext } from '../config-provider';\nimport { ConfirmContent } from './ConfirmDialog';\nimport { Footer, renderCloseIcon } from './shared';\nimport useStyle from './style';\nimport useCSSVarCls from '../config-provider/hooks/useCSSVarCls';\nconst PurePanel = props => {\n  const {\n      prefixCls: customizePrefixCls,\n      className,\n      closeIcon,\n      closable,\n      type,\n      title,\n      children,\n      footer\n    } = props,\n    restProps = __rest(props, [\"prefixCls\", \"className\", \"closeIcon\", \"closable\", \"type\", \"title\", \"children\", \"footer\"]);\n  const {\n    getPrefixCls\n  } = React.useContext(ConfigContext);\n  const rootPrefixCls = getPrefixCls();\n  const prefixCls = customizePrefixCls || getPrefixCls('modal');\n  const rootCls = useCSSVarCls(rootPrefixCls);\n  const [wrapCSSVar, hashId, cssVarCls] = useStyle(prefixCls, rootCls);\n  const confirmPrefixCls = `${prefixCls}-confirm`;\n  // Choose target props by confirm mark\n  let additionalProps = {};\n  if (type) {\n    additionalProps = {\n      closable: closable !== null && closable !== void 0 ? closable : false,\n      title: '',\n      footer: '',\n      children: ( /*#__PURE__*/React.createElement(ConfirmContent, Object.assign({}, props, {\n        prefixCls: prefixCls,\n        confirmPrefixCls: confirmPrefixCls,\n        rootPrefixCls: rootPrefixCls,\n        content: children\n      })))\n    };\n  } else {\n    additionalProps = {\n      closable: closable !== null && closable !== void 0 ? closable : true,\n      title,\n      footer: footer !== null && /*#__PURE__*/React.createElement(Footer, Object.assign({}, props)),\n      children\n    };\n  }\n  return wrapCSSVar( /*#__PURE__*/React.createElement(Panel, Object.assign({\n    prefixCls: prefixCls,\n    className: classNames(hashId, `${prefixCls}-pure-panel`, type && confirmPrefixCls, type && `${confirmPrefixCls}-${type}`, className, cssVarCls, rootCls)\n  }, restProps, {\n    closeIcon: renderCloseIcon(prefixCls, closeIcon),\n    closable: closable\n  }, additionalProps)));\n};\nexport default withPureRenderTheme(PurePanel);","\"use client\";\n\nimport confirm, { modalGlobalConfig, withConfirm, withError, withInfo, withSuccess, withWarn } from './confirm';\nimport destroyFns from './destroyFns';\nimport OriginModal from './Modal';\nimport PurePanel from './PurePanel';\nimport useModal from './useModal';\nfunction modalWarn(props) {\n  return confirm(withWarn(props));\n}\nconst Modal = OriginModal;\nModal.useModal = useModal;\nModal.info = function infoFn(props) {\n  return confirm(withInfo(props));\n};\nModal.success = function successFn(props) {\n  return confirm(withSuccess(props));\n};\nModal.error = function errorFn(props) {\n  return confirm(withError(props));\n};\nModal.warning = modalWarn;\nModal.warn = modalWarn;\nModal.confirm = function confirmFn(props) {\n  return confirm(withConfirm(props));\n};\nModal.destroyAll = function destroyAllFn() {\n  while (destroyFns.length) {\n    const close = destroyFns.pop();\n    if (close) {\n      close();\n    }\n  }\n};\nModal.config = modalGlobalConfig;\nModal._InternalPanelDoNotUseOrYouWillBeFired = PurePanel;\nif (process.env.NODE_ENV !== 'production') {\n  Modal.displayName = 'Modal';\n}\nexport default Modal;","import { useState, forwardRef, useImperativeHandle } from \"react\";\r\nimport { Modal, Space, Button, Form, Input, App } from \"antd\";\r\nimport useLoadingDelayAndKeep from \"@/hooks/useLoadingDelayAndKeep\";\r\nimport axios from \"@/utils/axios\";\r\n\r\nconst AddOrEdit = forwardRef((props, ref) => {\r\n  const { message } = App.useApp();\r\n\r\n  const [headForm] = Form.useForm();\r\n\r\n  const [id, setId] = useState(\"\");\r\n  const [visible, setVisible] = useState(false);\r\n  const [loading, { setTrue, setFalse }] = useLoadingDelayAndKeep(false);\r\n\r\n  const onSubmit = function (data) {\r\n    setTrue(true);\r\n    const apiUrl = id ? \"/api/role/update\" : \"/api/role/add\";\r\n    const successMsg = id ? \"更新成功！\" : \"新增成功！\";\r\n    const params = id ? { id, ...data } : data;\r\n    const callback = () => props.callback?.(id ? undefined : 1);\r\n    axios\r\n      .post(apiUrl, params)\r\n      .then(() => {\r\n        setVisible(false);\r\n        message.success(successMsg);\r\n        callback();\r\n      })\r\n      .finally(() => setFalse());\r\n  };\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    addStart: () => setVisible(true),\r\n    editStart: (row) => {\r\n      setId(row.id);\r\n      headForm.setFieldsValue(row);\r\n      setVisible(true);\r\n    },\r\n  }));\r\n\r\n  return (\r\n    <Modal\r\n      title={id ? \"编辑\" : \"新增\"}\r\n      open={visible}\r\n      width={600}\r\n      footer={\r\n        <Space>\r\n          <Button onClick={() => setVisible(false)}>取消</Button>\r\n          <Button\r\n            type=\"primary\"\r\n            loading={loading}\r\n            onClick={() => headForm.submit()}\r\n          >\r\n            确定\r\n          </Button>\r\n        </Space>\r\n      }\r\n      onCancel={() => setVisible(false)}\r\n      afterClose={() => {\r\n        setId(\"\");\r\n        headForm.resetFields();\r\n      }}\r\n    >\r\n      <Form\r\n        form={headForm}\r\n        layout=\"vertical\"\r\n        onFinish={onSubmit}\r\n        autoComplete=\"off\"\r\n      >\r\n        <Form.Item\r\n          name=\"roleName\"\r\n          label=\"角色名称\"\r\n          rules={[{ required: true, message: \"请填写角色名称\" }]}\r\n        >\r\n          <Input placeholder=\"请输入\" />\r\n        </Form.Item>\r\n        <Form.Item name=\"description\" label=\"备注\">\r\n          <Input.TextArea placeholder=\"请输入\" />\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n});\r\n\r\nexport default AddOrEdit;\r\n","import { useRef } from \"react\";\r\nimport { Button, Space, App } from \"antd\";\r\nimport { PlusOutlined } from \"@ant-design/icons\";\r\nimport ProTable from \"@/components/ProTable\";\r\nimport axios from \"@/utils/axios\";\r\nimport OptimisticSwitch from \"@/components/OptimisticSwitch\";\r\nimport AddOrEdit from \"./AddOrEdit\";\r\nimport { roleEnabledState } from \"@/utils/dict\";\r\nimport PermissionControl, {\r\n  useFilterElementPermission,\r\n} from \"@/components/PermissionControl\";\r\n\r\nexport default function Page() {\r\n  const { message } = App.useApp();\r\n\r\n  // 更新角色状态\r\n  const updateStatus = function (id, status) {\r\n    return axios.post(\"/api/role/status/update\", { id, status }).then(() => {\r\n      // 如果觉得需要，也可以在此刷新表格\r\n      message.success(\"切换成功！\");\r\n    });\r\n  };\r\n\r\n  const tableRef = useRef();\r\n  const addOrEditRef = useRef();\r\n\r\n  // 表格的操作栏\r\n  const [actionRender, isShowAction] = useFilterElementPermission(\r\n    {\r\n      render: (row) => (\r\n        <Button type=\"primary\" ghost size=\"small\">\r\n          编辑\r\n        </Button>\r\n      ),\r\n      permission: \"edit\",\r\n    },\r\n    {\r\n      render: (row) => (\r\n        <Button type=\"primary\" size=\"small\">\r\n          授权\r\n        </Button>\r\n      ),\r\n      permission: \"accredit\",\r\n    },\r\n    {\r\n      render: (row) => (\r\n        <Button type=\"primary\" danger size=\"small\">\r\n          删除\r\n        </Button>\r\n      ),\r\n      permission: \"del\",\r\n    }\r\n  );\r\n\r\n  const columns = [\r\n    {\r\n      title: \"角色名称\",\r\n      dataIndex: \"roleName\",\r\n    },\r\n    {\r\n      title: \"备注\",\r\n      dataIndex: \"description\",\r\n      hideInSearch: true,\r\n    },\r\n    {\r\n      title: \"状态\",\r\n      dataIndex: \"status\",\r\n      render: (status, row) => {\r\n        const { enabled, disabled } = roleEnabledState.enum;\r\n        return (\r\n          <OptimisticSwitch\r\n            defaultChecked={status === enabled}\r\n            onChange={(val) => updateStatus(row.id, val ? enabled : disabled)}\r\n          />\r\n        );\r\n      },\r\n      type: \"select\",\r\n      options: roleEnabledState.options,\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      key: \"action\",\r\n      render: (row) => <Space>{actionRender(row)}</Space>,\r\n      width: 100,\r\n      fixed: \"right\",\r\n      hideInSearch: true,\r\n      hideInTable: !isShowAction,\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      <ProTable\r\n        ref={tableRef}\r\n        columns={columns}\r\n        rowKey=\"id\"\r\n        headerTitle=\"角色列表\"\r\n        request={(params, { current, pageSize }) =>\r\n          axios\r\n            .post(\"/api/role/page\", { params, pageIndex: current, pageSize })\r\n            .then((value) => {\r\n              const { result: data } = value;\r\n              return {\r\n                list: data.records,\r\n                total: data.total,\r\n              };\r\n            })\r\n        }\r\n        toolBarRender={() => (\r\n          <PermissionControl permission=\"add\">\r\n            <Button\r\n              type=\"primary\"\r\n              icon={<PlusOutlined />}\r\n              onClick={() => addOrEditRef.current.addStart()}\r\n            >\r\n              新增\r\n            </Button>\r\n          </PermissionControl>\r\n        )}\r\n      />\r\n\r\n      <AddOrEdit\r\n        ref={addOrEditRef}\r\n        callback={(pageIndex) => tableRef.current.refresh(pageIndex)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"],"names":["useButtonAuthorization","pathname","useLocation","currentRoute","useSelector","selectMenuFlatten","find","item","path","butId","buttonList","some","id","useFilterElementPermission","permissionElements","hasButtonPermission","filteredElements","filter","permission","argument","_jsx","Fragment","children","map","element","render","length","PermissionControl","undefined","OptimisticSwitch","defaultChecked","onChange","checked","set","useBoolean","loading","setTrue","setFalse","useLoadingDelayAndKeep","Switch","val","catch","finally","props","prefixCls","customizePrefixCls","className","closeIcon","closable","type","title","footer","restProps","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","propertyIsEnumerable","__rest","getPrefixCls","rootPrefixCls","rootCls","useCSSVarCls","wrapCSSVar","hashId","cssVarCls","confirmPrefixCls","additionalProps","assign","content","modalWarn","useModal","info","success","error","warning","warn","confirm","destroyAll","destroyFns","close","config","_InternalPanelDoNotUseOrYouWillBeFired","forwardRef","ref","message","App","headForm","Form","setId","useState","visible","setVisible","useImperativeHandle","addStart","editStart","row","setFieldsValue","Modal","open","width","_jsxs","Space","Button","onClick","submit","onCancel","afterClose","resetFields","form","layout","onFinish","data","apiUrl","successMsg","params","axios","then","callback","autoComplete","name","label","rules","required","Input","placeholder","Page","tableRef","useRef","addOrEditRef","actionRender","isShowAction","ghost","size","danger","columns","dataIndex","hideInSearch","status","enabled","disabled","roleEnabledState","updateStatus","options","key","fixed","hideInTable","_Fragment","ProTable","rowKey","headerTitle","request","current","pageSize","pageIndex","value","result","list","records","total","toolBarRender","icon","PlusOutlined","AddOrEdit","refresh"],"sourceRoot":""}