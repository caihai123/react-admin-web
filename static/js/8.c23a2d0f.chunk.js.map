{"version":3,"file":"static/js/8.c23a2d0f.chunk.js","mappings":"yQAMe,SAASA,GAAiB,eACvCC,GAAiB,EAAK,SACtBC,EAAWA,KAAM,QAEjB,MAAOC,GAAS,IAAEC,KAASC,EAAAA,EAAAA,GAAWJ,IAC/BK,GAAS,QAAEC,EAAO,SAAEC,KAAcC,EAAAA,EAAAA,KAAuB,GAEhE,OACEC,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CACLR,QAASA,EACTG,QAASA,EACTJ,SAAWU,IACTR,EAAIQ,GACJL,IACAL,EAASU,IACLC,OAAM,KACNT,GAAKQ,EAAI,IAEVE,SAAQ,IAAMN,KAAW,GAIpC,CCtBe,SAASO,IACtB,MAAM,QAAEC,GAAYC,EAAAA,EAAAA,SAUdC,EAAU,CACd,CACEC,MAAO,OACPC,UAAW,YAEb,CACED,MAAO,KACPC,UAAW,cACXC,cAAc,GAEhB,CACEF,MAAO,KACPC,UAAW,SACXE,OAAQA,CAACC,EAAQC,KACfd,EAAAA,EAAAA,KAACV,EAAgB,CACfC,eAA2B,IAAXsB,EAChBrB,SAAWU,GAvBE,SAAUa,EAAIF,GACjC,OAAOG,EAAAA,EAAAA,KAAW,0BAA2B,CAAED,KAAIF,WAAUI,MAAK,KAEhEX,EAAQY,QAAQ,QAAQ,GAE5B,CAkB2BC,CAAaL,EAAIC,GAAIb,EAAM,EAAI,KAGtDkB,KAAM,SACNC,QAAS,CACP,CAAEC,MAAO,KAAMC,MAAO,KACtB,CAAED,MAAO,KAAMC,MAAO,OAG1B,CACEd,MAAO,KACPe,IAAK,SACLZ,OAASE,IACPW,EAAAA,EAAAA,MAACC,EAAAA,EAAK,CAAAC,SAAA,EACJ3B,EAAAA,EAAAA,KAAC4B,EAAAA,GAAM,CAACR,KAAK,UAAUS,OAAK,EAACC,KAAK,QAAOH,SAAC,QAG1C3B,EAAAA,EAAAA,KAAC4B,EAAAA,GAAM,CAACR,KAAK,UAAUU,KAAK,QAAOH,SAAC,QAGpC3B,EAAAA,EAAAA,KAAC4B,EAAAA,GAAM,CAACR,KAAK,UAAUW,QAAM,EAACD,KAAK,QAAOH,SAAC,UAK/CK,MAAO,IACPC,MAAO,QACPtB,cAAc,IAIlB,OACEX,EAAAA,EAAAA,KAACkC,EAAAA,EAAQ,CACP1B,QAASA,EACT2B,OAAO,KACPC,YAAY,OACZC,QAASA,CAACC,GAAUC,UAASC,cAC3BxB,EAAAA,EAAAA,KACQ,iBAAkB,CAAEsB,SAAQG,UAAWF,EAASC,aACrDvB,MAAMM,IACL,MAAQmB,OAAQC,GAASpB,EACzB,MAAO,CACLqB,KAAMD,EAAKE,QACXC,MAAOH,EAAKG,MACb,IAGPC,cAAeA,IAAM,EACnB/C,EAAAA,EAAAA,KAAC4B,EAAAA,GAAM,CAELR,KAAK,UACL4B,MAAMhD,EAAAA,EAAAA,KAACiD,EAAAA,EAAY,IACnBC,QAASA,IAAM5C,EAAQ6C,QAAQ,QAAQxB,SACxC,MAJK,SAUd,C","sources":["webpack://react-admin-web/./src/components/OptimisticSwitch.jsx","webpack://react-admin-web/./src/pages/permis/role/index.jsx"],"sourcesContent":["import { useBoolean } from \"ahooks\";\r\nimport { Switch } from \"antd\";\r\nimport useLoadingDelayAndKeep from \"@/hooks/useLoadingDelayAndKeep\";\r\n\r\n// 切换失败时自动撤销的 Optimistic Updates 开关\r\n// 注意：暂时还没完全想清楚此组件要不要作为公共基础组件存在\r\nexport default function OptimisticSwitch({\r\n  defaultChecked = false,\r\n  onChange = () => null,\r\n}) {\r\n  const [checked, { set }] = useBoolean(defaultChecked);\r\n  const [loading, { setTrue, setFalse }] = useLoadingDelayAndKeep(false);\r\n\r\n  return (\r\n    <Switch\r\n      checked={checked}\r\n      loading={loading}\r\n      onChange={(val) => {\r\n        set(val);\r\n        setTrue();\r\n        onChange(val)\r\n          ?.catch(() => {\r\n            set(!val);\r\n          })\r\n          .finally(() => setFalse());\r\n      }}\r\n    ></Switch>\r\n  );\r\n}\r\n","import { Button, Space, App } from \"antd\";\r\nimport { PlusOutlined } from \"@ant-design/icons\";\r\nimport ProTable from \"@/components/ProTable\";\r\nimport axios from \"@/utils/axios\";\r\nimport OptimisticSwitch from \"@/components/OptimisticSwitch\";\r\n\r\nexport default function Page() {\r\n  const { message } = App.useApp();\r\n\r\n  // 更新角色状态\r\n  const updateStatus = function (id, status) {\r\n    return axios.post(\"/api/role/status/update\", { id, status }).then(() => {\r\n      // 如果觉得需要，也可以在此刷新表格\r\n      message.success(\"切换成功！\");\r\n    });\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: \"角色名称\",\r\n      dataIndex: \"roleName\",\r\n    },\r\n    {\r\n      title: \"备注\",\r\n      dataIndex: \"description\",\r\n      hideInSearch: true,\r\n    },\r\n    {\r\n      title: \"状态\",\r\n      dataIndex: \"status\",\r\n      render: (status, row) => (\r\n        <OptimisticSwitch\r\n          defaultChecked={status === 1}\r\n          onChange={(val) => updateStatus(row.id, val ? 1 : 0)}\r\n        />\r\n      ),\r\n      type: \"select\",\r\n      options: [\r\n        { label: \"启用\", value: \"1\" },\r\n        { label: \"禁用\", value: \"0\" },\r\n      ],\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      key: \"action\",\r\n      render: (row) => (\r\n        <Space>\r\n          <Button type=\"primary\" ghost size=\"small\">\r\n            编辑\r\n          </Button>\r\n          <Button type=\"primary\" size=\"small\">\r\n            授权\r\n          </Button>\r\n          <Button type=\"primary\" danger size=\"small\">\r\n            删除\r\n          </Button>\r\n        </Space>\r\n      ),\r\n      width: 100,\r\n      fixed: \"right\",\r\n      hideInSearch: true,\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <ProTable\r\n      columns={columns}\r\n      rowKey=\"id\"\r\n      headerTitle=\"角色列表\"\r\n      request={(params, { current, pageSize }) =>\r\n        axios\r\n          .post(\"/api/role/page\", { params, pageIndex: current, pageSize })\r\n          .then((value) => {\r\n            const { result: data } = value;\r\n            return {\r\n              list: data.records,\r\n              total: data.total,\r\n            };\r\n          })\r\n      }\r\n      toolBarRender={() => [\r\n        <Button\r\n          key=\"add\"\r\n          type=\"primary\"\r\n          icon={<PlusOutlined />}\r\n          onClick={() => message.warning(\"演示功能\")}\r\n        >\r\n          新增\r\n        </Button>,\r\n      ]}\r\n    />\r\n  );\r\n}\r\n"],"names":["OptimisticSwitch","defaultChecked","onChange","checked","set","useBoolean","loading","setTrue","setFalse","useLoadingDelayAndKeep","_jsx","Switch","val","catch","finally","Page","message","App","columns","title","dataIndex","hideInSearch","render","status","row","id","axios","then","success","updateStatus","type","options","label","value","key","_jsxs","Space","children","Button","ghost","size","danger","width","fixed","ProTable","rowKey","headerTitle","request","params","current","pageSize","pageIndex","result","data","list","records","total","toolBarRender","icon","PlusOutlined","onClick","warning"],"sourceRoot":""}