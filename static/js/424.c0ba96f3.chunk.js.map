{"version":3,"file":"static/js/424.c0ba96f3.chunk.js","mappings":"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","sources":["webpack://react-admin-web/./src/pages/permis/account/index.jsx","webpack://react-admin-web/./src/store/api/deptSlice.js"],"sourcesContent":["import { Button, message, Space, Switch, Tag } from \"antd\";\r\nimport axios from \"@/utils/axios\";\r\nimport ProTable from \"@/components/ProTable\";\r\nimport { PlusOutlined } from \"@ant-design/icons\";\r\nimport { gender as genderDict } from \"@/utils/dict\";\r\nimport { useGetDeptSelectQuery } from \"@/store/api/deptSlice\";\r\n\r\nexport default function Page() {\r\n  const { data: depeOptions } = useGetDeptSelectQuery();\r\n\r\n  const columns = [\r\n    {\r\n      title: \"真实姓名\",\r\n      dataIndex: \"name\",\r\n    },\r\n    {\r\n      title: \"账号\",\r\n      dataIndex: \"account\",\r\n    },\r\n    {\r\n      title: \"性别\",\r\n      dataIndex: \"gender\",\r\n      render: (gender) => {\r\n        const map = genderDict.map[gender];\r\n        const tag = {\r\n          color: map?.color || \"rgba(0,0,0,.25)\",\r\n          label: map?.label || \"未知\",\r\n        };\r\n        return <Tag color={tag.color}>{tag.label}</Tag>;\r\n      },\r\n      type: \"select\",\r\n      options: genderDict.options,\r\n    },\r\n    {\r\n      title: \"手机号\",\r\n      dataIndex: \"phone\",\r\n    },\r\n    {\r\n      title: \"邮箱\",\r\n      dataIndex: \"email\",\r\n    },\r\n    {\r\n      title: \"状态\",\r\n      dataIndex: \"status\",\r\n      render: (status) => <Switch checked={status === 1} />,\r\n      type: \"select\",\r\n      options: [\r\n        { label: \"启用\", value: 1 },\r\n        { label: \"禁用\", value: 0 },\r\n      ],\r\n    },\r\n    {\r\n      title: \"部门\",\r\n      dataIndex: \"deptId\",\r\n      type: \"treeSelect\",\r\n      options: depeOptions,\r\n      render: (_, row) => row.deptName,\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      key: \"action\",\r\n      render: (row) => (\r\n        <Space>\r\n          <Button type=\"primary\" ghost size=\"small\">\r\n            编辑\r\n          </Button>\r\n          <Button type=\"primary\" size=\"small\">\r\n            授权\r\n          </Button>\r\n          <Button type=\"primary\" danger size=\"small\">\r\n            删除\r\n          </Button>\r\n        </Space>\r\n      ),\r\n      width: 100,\r\n      fixed: \"right\",\r\n      hideInSearch: true,\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <ProTable\r\n      columns={columns}\r\n      rowKey=\"id\"\r\n      headerTitle=\"用户列表\"\r\n      request={(params, { current, pageSize }) => {\r\n        return axios\r\n          .post(\"/api/account/page\", { params, pageIndex: current, pageSize })\r\n          .then((value) => {\r\n            const { result: data } = value;\r\n            return {\r\n              list: data.records,\r\n              total: data.total,\r\n            };\r\n          });\r\n      }}\r\n      batchBarRender={[\r\n        <Button\r\n          type=\"primary\"\r\n          key=\"del\"\r\n          danger\r\n          onClick={() => message.warning(\"演示功能\")}\r\n        >\r\n          批量删除\r\n        </Button>,\r\n        <Button\r\n          type=\"primary\"\r\n          key=\"export\"\r\n          onClick={() => message.warning(\"演示功能\")}\r\n        >\r\n          导出数据\r\n        </Button>,\r\n      ]}\r\n      toolBarRender={\r\n        <Button\r\n          type=\"primary\"\r\n          icon={<PlusOutlined />}\r\n          onClick={() => message.warning(\"演示功能\")}\r\n        >\r\n          新增\r\n        </Button>\r\n      }\r\n    />\r\n  );\r\n}\r\n","import apiSlice from \"../apiSlice\";\r\n\r\nexport const deptSlice = apiSlice.injectEndpoints({\r\n  endpoints: (builder) => ({\r\n    // 获取所有部门\r\n    getDeptAll: builder.query({\r\n      query: () => \"/api/dept/list\",\r\n      providesTags: [\"deptList\"],\r\n    }),\r\n    // 获取部门选择器\r\n    getDeptSelect: builder.query({\r\n      query: () => \"/api/dept/select\",\r\n      providesTags: [\"DeptSelect\"],\r\n    }),\r\n    // 新增单个部门\r\n    addDeptItem: builder.mutation({\r\n      query: (body) => ({\r\n        url: \"/api/dept/add\",\r\n        method: \"POST\",\r\n        body,\r\n      }),\r\n      invalidatesTags: [\"deptList\", \"DeptSelect\"],\r\n    }),\r\n    // 更新单个部门\r\n    updateDeptItem: builder.mutation({\r\n      query: (body) => ({\r\n        url: \"/api/dept/update\",\r\n        method: \"POST\",\r\n        body,\r\n      }),\r\n      invalidatesTags: [\"deptList\", \"DeptSelect\"],\r\n    }),\r\n    // 删除单个部门\r\n    deleteDeptItem: builder.mutation({\r\n      query: (body) => ({\r\n        url: \"/api/dept/delete\",\r\n        method: \"POST\",\r\n        body,\r\n      }),\r\n      invalidatesTags: [\"deptList\", \"DeptSelect\"],\r\n      async onQueryStarted({ id }, { dispatch, queryFulfilled }) {\r\n        const patchResult = dispatch(\r\n          apiSlice.util.updateQueryData(\"getDeptAll\", undefined, (draft) => {\r\n            return draft.filter((dept) => dept.id !== id);\r\n          })\r\n        );\r\n        try {\r\n          await queryFulfilled;\r\n        } catch {\r\n          patchResult.undo();\r\n        }\r\n      },\r\n    }),\r\n  }),\r\n});\r\n\r\nexport const {\r\n  useGetDeptAllQuery,\r\n  useGetDeptSelectQuery,\r\n  useAddDeptItemMutation,\r\n  useUpdateDeptItemMutation,\r\n  useDeleteDeptItemMutation,\r\n} = deptSlice;\r\n"],"names":["Page","data","depeOptions","useGetDeptSelectQuery","columns","title","dataIndex","render","gender","map","genderDict","tag","color","label","_jsx","Tag","children","type","options","status","Switch","checked","value","_","row","deptName","key","_jsxs","Space","Button","ghost","size","danger","width","fixed","hideInSearch","ProTable","rowKey","headerTitle","request","params","current","pageSize","axios","pageIndex","then","result","list","records","total","batchBarRender","onClick","message","toolBarRender","icon","PlusOutlined","deptSlice","apiSlice","endpoints","builder","getDeptAll","query","providesTags","getDeptSelect","addDeptItem","mutation","body","url","method","invalidatesTags","updateDeptItem","deleteDeptItem","async","id","dispatch","queryFulfilled","patchResult","undefined","draft","filter","dept","undo","useGetDeptAllQuery","useAddDeptItemMutation","useUpdateDeptItemMutation","useDeleteDeptItemMutation"],"sourceRoot":""}